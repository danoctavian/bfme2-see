;------------------------------------------------------------------------------
Object CreepBalrog

	; *** ART Parameters ***
  ; SelectPortrait for Heros is portrait behind skill buttons. HP = HeroPortrait.
	SelectPortrait = HPBalrog
  
  ; ButtonImage for Heros is button image on Hero Select UI to select hero. HI = HeroIcon or HeroImage.
	ButtonImage = HIBalrog
  
	Draw = W3DScriptedModelDraw ModuleTag_BodyDraw
		GlowEnabled = Yes //These were disabled by EA?
		GlowEmissive = Yes //What do they do?
		
		; StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

		OkToChangeModelColor = Yes
	
		ExtraPublicBone = ZZZPASSENGERBON
		ExtraPublicBone = ZZZWHIPCOIL
		ExtraPublicBone = SWORD

		;-------------------------
		ModelConditionState = NONE ; Not DefaultConditionState, because that keyword copies anything in here to every other state
			Model = MUBalrog_SKN
			ParticleSysBone = SWORD BalrogSwordFlare FollowBone:yes		; Not SWORDBONE, because SWORD is the bone that gets art-hidden mid animation in WIPX
			ParticleSysBone = SWORD BalrogSwordEmbers FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFlare FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeEmbers FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFire FollowBone:yes
			ParticleSysBone = RTWINGBONE BalrogWingSmokeLite FollowBone:yes
			ParticleSysBone = LFWINGBONE BalrogWingSmokeLite FollowBone:yes
		End

; This is triggered by the single player only HitReaction module for the lightningsword		
    ModelConditionState = HIT_LEVEL_2
			Model = MUBalLIT_SKN			
		End

; This is triggered by the IGNITE power!
		ModelConditionState = HERO
			Model = MUBalIGNT_SKN
			ParticleSysBone = MANEBONE BalrogManeFlare FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeEmbers FollowBone:yes
			ParticleSysBone = MANEBONE BalrogManeFire FollowBone:yes
			ParticleSysBone = RTWINGBONE BalrogWingSmokeLite FollowBone:yes	;BalrogWingEmbers, gives too much ember fx /Naz
			ParticleSysBone = LFWINGBONE BalrogWingSmokeLite FollowBone:yes	;BalrogWingEmbers, gives too much ember fx /Naz
			ParticleSysBone = SWORD BalrogSwordFlare FollowBone:yes		; Not SWORDBONE, because SWORD is the bone that gets art-hidden mid animation in WIPX
			ParticleSysBone = SWORD BalrogSwordEmbers FollowBone:yes
      ParticleSysBone = NONE BalrogIgniteHeatWave FollowBone:no
	  
			// Director's Cut Fire FX, added for S.E.E. by Nazgûl ----------------------	
			ParticleSysBone = MANEBONE SmokeColumnLarge FollowBone:yes
			
			ParticleSysBone = BAT_HEAD FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_HEAD FireSmall FollowBone:yes			
			
			ParticleSysBone = BAT_JAW FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_JAW FireSmall FollowBone:yes					
			
			ParticleSysBone = BAT_NECK FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_NECK FireSmall FollowBone:yes			
			
			ParticleSysBone = NECKBASE FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = NECKBASE FireSmall FollowBone:yes
			ParticleSysBone = NECKBASE BalrogManeEmbers FollowBone:yes

			// Torso ------------		
			ParticleSysBone = BAT_SPINE2 FireBuildingLargeSmoke FollowBone:yes
			;ParticleSysBone = BAT_SPINE2 FireSmall FollowBone:yes					//DO NOT USE THIS BONE AS IT ALSO IGNITES THE "ZZZPASSENGERBON"?
			ParticleSysBone = BAT_SPINE2 BalrogManeEmbers FollowBone:yes
			
			ParticleSysBone = BAT_SPINE1 FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_SPINE1 FireBuildingLarge FollowBone:yes					;FireSmall
			ParticleSysBone = BAT_SPINE1 BalrogManeEmbers FollowBone:yes
			
			ParticleSysBone = BAT_SHOULDER_L FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_SHOULDER_L FireBuildingLarge FollowBone:yes				;FireSmall
			
			ParticleSysBone = BAT_SHOULDER_R FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_SHOULDER_R FireBuildingLarge FollowBone:yes				;FireSmall
			
			ParticleSysBone = BAT_ELBOW_L FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_ELBOW_L FireSmall FollowBone:yes		
			
			ParticleSysBone = BAT_ELBOW_R FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_ELBOW_R FireSmall FollowBone:yes			

			ParticleSysBone = BAT_HAND_L FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_HAND_L FireSmall FollowBone:yes		
			
			ParticleSysBone = BAT_HAND_R FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_HAND_R FireSmall FollowBone:yes	

			// Legs -------------
			ParticleSysBone = BAT_HIP_L FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_HIP_L FireSmall FollowBone:yes
			ParticleSysBone = BAT_HIP_R FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_HIP_R FireSmall FollowBone:yes	

			ParticleSysBone = BAT_ANCLE_L FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_ANCLE_L FireSmall FollowBone:yes
			ParticleSysBone = BAT_ANCLE_R FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_ANCLE_R FireSmall FollowBone:yes	

			// Tail ---------------
			ParticleSysBone = BAT_TAIL_1 FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_TAIL_1 FireSmall FollowBone:yes
			ParticleSysBone = BAT_TAIL_2 FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_TAIL_2 FireSmall FollowBone:yes
			ParticleSysBone = BAT_TAIL_3 FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_TAIL_3 FireSmall FollowBone:yes			
			
			// Wings ------------
			ParticleSysBone = BAT_W_SHLDR_L FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_W_SHLDR_L FireSmall FollowBone:yes		
			ParticleSysBone = BAT_W_SHLDR_R FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_W_SHLDR_R FireSmall FollowBone:yes								

			ParticleSysBone = BAT_W_ELBO_L FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_W_ELBO_L FireSmall FollowBone:yes		
			ParticleSysBone = BAT_W_ELBO_R FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_W_ELBO_R FireSmall FollowBone:yes
			
			ParticleSysBone = BAT_W_ELBOFGR_L FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_W_ELBOFGR_L FireSmall FollowBone:yes		
			ParticleSysBone = BAT_W_ELBOFGR_R FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_W_ELBOFGR_R FireSmall FollowBone:yes			
			
			ParticleSysBone = BAT_W_HAND_L FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_W_HAND_L FireSmall FollowBone:yes		
			ParticleSysBone = BAT_W_HAND_R FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone = BAT_W_HAND_R FireSmall FollowBone:yes			
		End

		;-----------------		
		IdleAnimationState
			StateName = State_Idle
			Animation = Breathe 
				AnimationName = MUBalrog_SKL.MUBalrog_IDLA
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 20
			End
			Animation = LookAround 
				AnimationName = MUBalrog_SKL.MUBalrog_IDLB
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 2
			End
			Animation = SnortLikeABull 
				AnimationName = MUBalrog_SKL.MUBalrog_IDLC
				AnimationMode = ONCE
				AnimationBlendTime = 10
				AnimationPriority = 1
			End

			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_JustBuilt" 
					then CurDrawableSetTransitionAnimState("TRANS_JustBuilt_To_Idle") 
				end
				if Prev == "State_AboutToHitGround" 
					then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") 
				end
			EndScript
		End 
		
		AnimationState					=	DYING DEATH_1
			Animation					=	Dying 
				AnimationName			=	MUBalrog_SKL.MUBalrog_DIEA 
				AnimationMode			=	ONCE
			End
			ParticleSysBone = None BalrogFallDust FollowBone:No
		End

		AnimationState					=	DYING DEATH_2
			Animation					=	FadingOut 
				AnimationName			=	MUBalrog_SKL.MUBalrog_RORC 
				AnimationMode			=	ONCE
			End
		End


; This is triggered by the single player only HitReaction module for the lightningsword	
; It is highest instead of lowest priority, because the hit reaction Paralyzes us, where for others it is just a fancy idle.	
		AnimationState					=	HIT_LEVEL_2
			Animation					=	Owowowowowowowow
				AnimationName			=	MUBalrog_SKL.MUBalrog_HITB 
				AnimationMode			=	ONCE
			End
		End
		
		AnimationState					=	EATING
			Animation					=	DoingHorribleThingToGrabbedGuy 
				AnimationName			=	MUBalrog_SKL.MUBalrog_BRNA ;Obsolete anim removed by EA?
				AnimationMode			=	ONCE
				AnimationBlendTime		=	0
			End
      ParticleSysBone = ZZZPassengerBon balrogHandSqueezeFlames FollowBone:Yes
      ParticleSysBone = ZZZPassengerBon balrogHandSqueezeFlames2 FollowBone:Yes
      ParticleSysBone = ZZZPassengerBon balrogHandSqueezeFlamesFinal FollowBone:Yes
      ParticleSysBone = ZZZPassengerBon BalrogHandSqueezeFlash FollowBone:Yes
      ParticleSysBone = ZZZPassengerBon BalrogHandSmoke FollowBone:Yes
      ParticleSysBone = RING_2_L balrogHandAsh FollowBone:Yes
      ParticleSysBone = RING_2_L balrogHandAshSmall FollowBone:Yes
		End

		AnimationState					=	UNPACKING PACKING_TYPE_3
			Animation					=	GrabbingToTouching
				AnimationName			=	MUBalrog_SKL.MUBalrog_GRBA ;Obsolete anim removed by EA?
				AnimationMode			=	ONCE
				AnimationBlendTime		=	0
			End
		End

		AnimationState					=	PACKING PACKING_TYPE_3
			Animation					=	GrabbingFollowThrough 
				AnimationName			=	MUBalrog_SKL.MUBalrog_GRBC ;Obsolete anim removed by EA?
				AnimationMode			=	ONCE
				AnimationBlendTime		=	0
			End	
		End

		AnimationState			= JUST_BUILT
			StateName = State_JustBuilt
			Animation
				AnimationName = MUBalrog_SKL.MUBalrog_RORA
				AnimationMode = MANUAL
				AnimationBlendTime = 0
			End
		End
		
	    TransitionState = TRANS_JustBuilt_To_Idle
			Animation = BeingSummoned
				AnimationName = MUBalrog_SKL.MUBalrog_RORA 
				AnimationMode = ONCE
			End
		End
		
		AnimationState			= TURN_RIGHT
			Animation			= TurningRight 
				AnimationName	= MUBalrog_SKL.MUBalrog_TRNA
				AnimationMode   = LOOP
				AnimationBlendTime = 10
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_AboutToHitGround" 
					then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") 
				end
			EndScript
		End

		AnimationState			= TURN_LEFT
			Animation			= TurningLeft 
				AnimationName	= MUBalrog_SKL.MUBalrog_TRNB
				AnimationMode   = LOOP
				AnimationBlendTime = 10
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_AboutToHitGround" 
					then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") 
				end
			EndScript
		End

		AnimationState = SPECIAL_WEAPON_THREE ;FIRING_OR_PREATTACK_B
			Animation = CrackThatWhip 
				AnimationName = MUBalrog_SKL.MUBalrog_WIPA
				AnimationMode = ONCE
			End
      ParticleSysBone = RTHANDBONE BalrogWhip2swordEfx FollowBone:Yes
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_AboutToHitGround" 
					then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") 
				end
			EndScript
		End

		AnimationState			= SPECIAL_POWER_1
			Animation			= RoaringFear 
				AnimationName	= MUBalrog_SKL.MUBalrog_RORB
				AnimationMode   = ONCE
			End
      ParticleSysBone = BAT_JAW BalrogScreamEffect FollowBone:Yes
      FXEvent			= Frame:20 Name:FX_BalrogScreamEfx
      ParticleSysBone = BAT_JAW balrogPixelDisplScrm FollowBone:Yes
      ParticleSysBone = BAT_JAW balrogScrmEmbers FollowBone:Yes
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_AboutToHitGround" 
					then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") 
				end
			EndScript
    End
			   
		AnimationState			= SPECIAL_WEAPON_ONE
			Animation			= BreathingFireAnimation
				AnimationName	= MUBalrog_SKL.MUBalrog_FIRA
				AnimationMode   = ONCE
			End
      ;This is Balrog's fire breath efx
      ParticleSysBone = BAT_JAW balrogFireBreath FollowBone:Yes
      ParticleSysBone = BAT_JAW balrogBreathEmbers FollowBone:Yes
      ParticleSysBone = BAT_JAW balrogBreathSmoke FollowBone:Yes
      ParticleSysBone = BAT_JAW balrogBreathProxy FollowBone:Yes
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_AboutToHitGround" 
					then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") 
				end
			EndScript
			End
			   
		AnimationState			= SPECIAL_WEAPON_TWO UNPACKING
			StateName			= State_LeapStart
			Animation			= GettingReadyToLeap
				AnimationName	= MUBalrog_SKL.MUBalrog_JMP1
				AnimationMode   = ONCE
			End
		End
			   
    AnimationState			= SPECIAL_WEAPON_TWO PACKING
			Animation			= FirstWingBeatGoingUp 
				AnimationName	= MUBalrog_SKL.MUBalrog_JMP2
				AnimationMode   = ONCE
			End
		End
			   
	    AnimationState			= ABOUT_TO_HIT						; Before ThrownProjectile, since by definition this set for nn frames while T_P is still on
			StateName			= State_AboutToHitGround
			Animation			= StartingToLandToTouchingGround 
				AnimationName	= MUBalrog_SKL.MUBalrog_LND1
				AnimationMode   = ONCE
			End
		End
			   
		AnimationState			= THROWN_PROJECTILE
			Animation			= HurtlingThroughAir 
				AnimationName	= MUBalrog_SKL.MUBalrog_FLYA
				AnimationMode   = LOOP
				AnimationBlendTime = 10
			End
		End
			   
    TransitionState = TRANS_AboutToHitGround_To_Idle
			Animation = SplashAtEndOfJump
				AnimationName = MUBalrog_SKL.MUBalrog_LND2 
				AnimationMode = ONCE
				AnimationBlendTime = 0
			End
		End
		
		AnimationState			= WEAPONSET_HERO_MODE UNPACKING PACKING_TYPE_1
			Animation = StartIgniteRoar 
				AnimationName = MUBalrog_SKL.MUBalrog_IGNTA
				AnimationMode = ONCE
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_AboutToHitGround" 
					then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") 
				end
			EndScript
		End
				
		AnimationState			= HERO PACKING PACKING_TYPE_1
			Animation = FinishIgniteRoar 
				AnimationName = MUBalrog_SKL.MUBalrog_IGNTB
				AnimationMode = ONCE
			End
      EnteringStateFX = FX_BalrogIgniteStart
		End
				
		AnimationState			= FIRING_OR_PREATTACK_A
			Animation			= Swipe
				AnimationName	= MUBalrog_SKL.MUBalrog_ATKB
				AnimationMode	= ONCE
				UseWeaponTiming	= Yes
			End
		End
		
		AnimationState			= FIRING_OR_PREATTACK_C
			Animation			= Chop
				AnimationName	= MUBalrog_SKL.MUBalrog_ATKA
				AnimationMode	= ONCE
				UseWeaponTiming	= Yes
			End
			ParticleSysBone		= SWORDBONE BalrogSword FollowBone:yes
		End
    
		AnimationState			= MOVING
			Animation			= Running 
				AnimationName	= MUBalrog_SKL.MUBalrog_WLKA
				AnimationMode   = LOOP
				AnimationBlendTime = 10
			End
			Flags               = RANDOMSTART
			FXEvent	= Frame:20 FireWhenSkipped Name:FX_BalrogRightFootStep
			FXEvent	= Frame:44 FireWhenSkipped Name:FX_BalrogLeftFootStep
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "State_AboutToHitGround" 
					then CurDrawableSetTransitionAnimState("TRANS_AboutToHitGround_To_Idle") 
				end
			EndScript
		End
      
	End

;--------------------------
	Draw = W3DScriptedModelDraw ModuleTag_WhipDraw
		GlowEnabled = Yes
		GlowEmissive = Yes
		ShadowForceDisable = Yes	;The shadow setting is for the whole drawable, but this individual draw module wants to not have a shadow.
		
;		StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD

		DefaultModelConditionState
			Model = None
		End
		
		ModelConditionState = SPECIAL_WEAPON_THREE ;FIRING_OR_PREATTACK_B
			Model = MUBalsWhip_SKN
		End
		
		;------------------
		IdleAnimationState
		End
		
		AnimationState = SPECIAL_WEAPON_THREE ;FIRING_OR_PREATTACK_B
			Animation = CrackThatWhip 
				AnimationName = MUBalsWhip_SKL.MUBalsWhip_WIPA
				AnimationMode = ONCE
				AnimationBlendTime = 0
			End
		End
		WadingParticleSys = BalrogRiverSteam		
	End

	; ***DESIGN parameters ***
	DisplayName      = OBJECT:Balrog
	;//DisplayMeleeDamage = BALROG_DAMAGE_DISPLAY

	Side = Neutral
	EditorSorting = UNIT
	ThreatLevel = BALROG_THREAT_LEVEL
	ThingClass = CHARACTER_UNIT
	CrusherLevel   = 4  ;What can I crush?: 1 = infantry, 2 = trees, 3 = vehicles
	CrushWeapon = BalrogCrush  

	TransportSlotCount = TRANSPORTSLOTCOUNT_MONSTER
	
	WeaponSet
		Conditions = None
		DefaultWeaponChoiceCritera = SELECT_AT_RANDOM
    
		Weapon = PRIMARY	MordorBalrogSwordSwipe
		; PreferredAgainst	= PRIMARY	HORDE CAN_RIDE_SIEGE_LADDER MONSTER INFANTRY CAVALRY
		; AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI

		; Weapon = SECONDARY	MordorBalrogWhip
		; // OnlyAgainst	= SECONDARY DOZER HERO MACHINE SHIP
		; PreferredAgainst	= SECONDARY DOZER HERO MACHINE SHIP
		; // AutoChooseSources = SECONDARY FROM_PLAYER FROM_SCRIPT FROM_AI ;None
		; // OnlyAgainst = SECONDARY DOZER HERO MACHINE SHIP INFANTRY CAVALRY MONSTER

		Weapon = TERTIARY	MordorBalrogSwordChop
		OnlyAgainst = TERTIARY STRUCTURE BIG_MONSTER
    
		ReadyStatusSharedWithinSet = Yes
	End
	
	ArmorSet
		Conditions      = None
		Armor           = BalrogArmor
		DamageFX        = NormalDamageFX
	End

	VisionRange = VISION_BALROG					
	ShroudClearingRange = SHROUD_CLEAR_BALROG

	DisplayName = OBJECT:Balrog
	ShockwaveResistance = SHOCKWAVE_RESISTANCE_ALWAYS
	CommandSet = BalrogCommandSet
	CanPathThroughGates	= No
	IsTrainable = No
	
	DeadCollideSize = LARGE ; How big does the AOD consider this unit for damage fx & behavior.


	;------------------ AUDIO Parameters ----------------------

	VoiceAttack			= BalrogVoiceAttack
	VoiceAttackCharge	= BalrogVoiceAttack
	VoiceAttackMachine	= BalrogVoiceAttack
	VoiceAttackStructure	= BalrogVoiceAttack
	VoiceGuard			= BalrogVoiceMove
	VoiceMove			= BalrogVoiceMove
	VoiceSelect			= BalrogVoiceSelect
	VoiceSelectBattle		= BalrogVoiceSelect

	SoundAmbient		= BalrogAmbientLoop
	SoundImpact			= ImpactHorse

    #include "..\includes\StandardUnitEvaEvents.inc"
	
    ; Warn the player when the enemy gets a unit. Override the normal sighting event from StandardUnitEvaEvents.inc
    EvaEnemyObjectSightedEvent	= DiscoveredEnemyBalrog

	ClientUpdate = EvaAnnounceClientCreate ModuleTag_CreateAnnounce
		AnnouncementEventEnemy = DiscoveredEnemyBalrog
		AnnouncementEventAlly = None
		AnnouncementEventOwner = None
		
		OnlyIfVisible = Yes						; Don't announce if hidden in the shroud
		CountAsFirstSightedAnnoucement = Yes	; Don't re-annouce if going into shroud & back
		UseObjectsPosition = No					; Play from central Fortress, not at unit's position
		CreateFakeRadarEvent = Yes				; Allow player to jump to unit after hearing annoucement
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound: BalrogFootstep			Animation: MUBalrog_SKL.MUBalrog_WLKA Frames: 42 17 
		AnimationSound = Sound: BalrogFootstep			Animation: MUBalrog_SKL.MUBalrog_TRNA Frames: 21 52
		AnimationSound = Sound: BalrogFootstep			Animation: MUBalrog_SKL.MUBalrog_TRNB Frames: 21 52
 
		AnimationSound = Sound: BalrogWhipPart1			Animation: MUBalrog_SKL.MUBalrog_WIPA Frames: 1 
		AnimationSound = Sound: BalrogWhipPart2			Animation: MUBalrog_SKL.MUBalrog_WIPA Frames: 21 
		AnimationSound = Sound: ImpactWhipCrack			Animation: MUBalrog_SKL.MUBalrog_WIPA Frames: 34

		AnimationSound = Sound: BalrogSwordSwipe			Animation: MUBalrog_SKL.MUBalrog_ATKB Frames: 32	
		AnimationSound = Sound: BalrogSwordSwipe			Animation: MUBalrog_SKL.MUBalrog_ATKA Frames: 32
		AnimationSound = Sound: ImpactBalrogAttackGeneric	Animation: MUBalrog_SKL.MUBalrog_ATKA Frames:41
		AnimationSound = Sound: ImpactBalrogAttackGeneric	Animation: MUBalrog_SKL.MUBalrog_ATKB Frames:40 
		AnimationSound = Sound: ImpactBalrogAttackGeneric	Animation: MUBalrog_SKL.MUBalrog_ATKC Frames:27 53 88

		AnimationSound = Sound: BalrogJump_Part1			Animation: MUBalrog_SKL.MUBalrog_JMP1 Frames: 0 
		AnimationSound = Sound: BalrogJump_Part2			Animation: MUBalrog_SKL.MUBalrog_JMP1 Frames: 41
		AnimationSound = Sound: BalrogWingFlaps			Animation: MUBalrog_SKL.MUBalrog_FLYA Frames: 9 
		AnimationSound = Sound: BalrogLand				Animation: MUBalrog_SKL.MUBalrog_LND1 Frames: 0
		AnimationSound = Sound: BalrogWingFlaps			Animation: MUBalrog_SKL.MUBalrog_JMP2 Frames: 0
		AnimationSound = Sound: BalrogLandSwordHit		Animation: MUBalrog_SKL.MUBalrog_LND2 Frames: 6
		AnimationSound = Sound: BalrogIdleB_Part3			Animation: MUBalrog_SKL.MUBalrog_LND2 Frames: 27

		AnimationSound = Sound: BalrogBreathFireExhale		Animation: MUBalrog_SKL.MUBalrog_FIRA Frames: 31 
		AnimationSound = Sound: BalrogBreathFireInhale		Animation: MUBalrog_SKL.MUBalrog_FIRA Frames: 0

		AnimationSound = Sound: BalrogRoar				Animation: MUBalrog_SKL.MUBalrog_RORB Frames: 25
		AnimationSound = Sound: BalrogVanquishedRoar		Animation: MUBalrog_SKL.MUBalrog_RORC Frames: 21
		AnimationSound = Sound: BalrogVanquished			Animation: MUBalrog_SKL.MUBalrog_RORC Frames: 50

		AnimationSound = Sound: BalrogInjuredB_Part1		Animation: MUBalrog_SKL.MUBalrog_HITB Frames: 0 
		AnimationSound = Sound: BalrogInjuredB_Part2		Animation: MUBalrog_SKL.MUBalrog_HITB Frames: 70 

		AnimationSound = Sound: BalrogChuckle			Animation: MUBalrog_SKL.MUBalrog_IDLA Frames: 1
		AnimationSound = Sound: BalrogContentVox			Animation: MUBalrog_SKL.MUBalrog_IDLA Frames: 0
		AnimationSound = Sound: BalrogIdleB_Part1			Animation: MUBalrog_SKL.MUBalrog_IDLB Frames: 0 
		AnimationSound = Sound: BalrogIdleB_Part2			Animation: MUBalrog_SKL.MUBalrog_IDLB Frames: 37 
		AnimationSound = Sound: BalrogIdleB_Part3			Animation: MUBalrog_SKL.MUBalrog_IDLB Frames: 95 
		AnimationSound = Sound: BalrogIdleC_Part2			Animation: MUBalrog_SKL.MUBalrog_IDLC Frames: 29 
		AnimationSound = Sound: BalrogIdleC_Part3			Animation: MUBalrog_SKL.MUBalrog_IDLC Frames: 60 
		AnimationSound = Sound: BalrogFootstep			Animation: MUBalrog_SKL.MUBalrog_IDLC Frames: 61

		AnimationSound = Sound: BalrogDieVox			Animation: MUBalrog_SKL.MUBalrog_DIEA Frames: 13
		AnimationSound = Sound: BalrogBodyfall1			Animation: MUBalrog_SKL.MUBalrog_DIEA Frames: 56
		AnimationSound = Sound: BalrogBodyfall2			Animation: MUBalrog_SKL.MUBalrog_DIEA Frames: 57
		AnimationSound = Sound: OliphantFall			Animation: MUBalrog_SKL.MUBalrog_DIEA Frames: 21
		AnimationSound = Sound: BalrogLandSwordHit		Animation: MUBalrog_SKL.MUBalrog_DIEA Frames: 54

		AnimationSound = Sound: BalrogIgnite			Animation: MUBalrog_SKL.MUBalrog_IGNTA Frames: 51
	End


  ; *** ENGINEERING Parameters ***  

	RadarPriority = UNIT
  KindOf          = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS MONSTER SCORE CAN_ATTACK NO_FREEWILL_ENTER PATH_THROUGH_INFANTRY SCARY BIG_MONSTER CAN_ATTACK_WALLS SUMMONED
  ThreatBreakdown MordorBalrog_DetailedThreat
    AIKindOf = SIEGEWEAPON
  End
	
  Body            = ActiveBody ModuleTag_02NEW
    MaxHealth         = BALROG_HEALTH					;BALANCE Balrog Health
  End

  Behavior = StancesBehavior ModuleTag_StancesBehavior
    StanceTemplate = Hero
  End

  Behavior = AIUpdateInterface ModuleTag_03
    AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
    MoodAttackCheckRate			= 500
    AILuaEventsList				= BalrogFunctions
  End

  LocomotorSet
    Locomotor     = BalrogLocomotor
    Condition     = SET_NORMAL
    Speed         = 50
  End

	Behavior = BezierProjectileBehavior ModuleTag_Projectile ; Module starts asleep, and wakes up when thrown.
		; To tweak a Bezier path
		FirstHeight = 104  ; Height of Bezier control points above highest intervening terrain
		SecondHeight = 52
		FirstPercentIndent = 20% ; Percentage of shot distance control points are placed
		SecondPercentIndent = 70%
		TumbleRandomly = Yes

		CrushStyle = Yes ; I don't detonate, I just hit

		BounceCount = 0   ; When I hit the ground, I'll arc again

		FinalStuckTime = 1766 ; Can't move for this long afterwards

		GroundHitFX       = FX_BalrogJumpHitGround
		GroundHitWeapon   = RohanGimliLeapWarhead
		
		PreLandingStateTime = 300; Look ahead to the end of the arc, and get the ABOUT_TO_HIT flag this far in advance
	End

	Behavior = PhysicsBehavior ModuleTag_04
	    GravityMult = 1.0
	End
  
	Behavior = FireWeaponUpdate FireWeaponUpdateModuleTag
		FireWeaponNugget
			WeaponName = MordorBalrogHeroEffect
			FireDelay = 0
			OneShot = No
		End
		HeroModeTrigger = Yes ; this only happens when hero mode is active
	End
  
  Behavior = SlowDeathBehavior ModuleTag_05
    DeathTypes = ALL -FADED
    DestructionDelay = 2500
    FX = FINAL FX_BalrogFinalDeath
    DeathFlags = DEATH_1
  End
  
  Behavior = SlowDeathBehavior ModuleTag_FadeDeath
    DeathTypes = NONE +FADED
    FX = INITIAL FX_BalrogUnsummonInitial
    DestructionDelay = 3800
    FX = FINAL FX_BalrogUnsummonFinal
    DeathFlags = DEATH_2
  End
  
  Behavior = SpecialPowerModule ModuleTag_IgniteStarter                      
		SpecialPowerTemplate      = SpecialAbilityHeroMode
		UpdateModuleStartsAttack  = Yes
		;InitiateSound           = 
	End
	Behavior = HeroModeSpecialAbilityUpdate ModuleTag_IgniteUpdate   
		SpecialPowerTemplate    = SpecialAbilityHeroMode
		UnpackingVariation		= 1
		UnpackTime              = 1800 
		PackTime                = 1600
		AwardXPForTriggering    = 0
		HeroAttributeModifier = BalrogIgniteState
		HeroEffectDuration = 30000
		MustFinishAbility		= Yes
		FreezeAfterTriggerDuration = 2000 ; Hold AI for this long after we fire.
  	ParalyzeDurationWhenCompleted = 500	;Once the unit SUCCESSFULLY COMPLETES an ability, paralyze unit briefly to deal with animation transitions.
  	ParalyzeDurationWhenAborted = 1000	;If the unit ABORTS the ability, paralyze the unit briefly to deal with animation transitions.
	End

	Behavior = SpecialPowerModule ModuleTag_WhipStarter                      
		SpecialPowerTemplate		= SpecialAbilityFireWhip
		UpdateModuleStartsAttack	= Yes
		InitiateSound			= BalrogSpecialPowerRoar	;this plays on right-click target, not when Balrog leaps
		StartsPaused			= No
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_WhipUpdate   
		; SkipContinue			= Yes
		SpecialPowerTemplate    = SpecialAbilityFireWhip
		; UnpackTime					= 2000 
		; PreparationTime				= 1   
		; PersistentPrepTime			= 1000 
		; PackTime					= 1
		UnpackTime              = 1000 ; Drawing the horn
		PackTime                = 1000 ; Putting horn away
		AwardXPForTriggering    = 0
		StartAbilityRange	= 300.0
		ApproachRequiresLOS = Yes
		SpecialWeapon		= MordorBalrogWhip
    FreezeAfterTriggerDuration 	= 1000 ; Hold AI for this long after we fire.
		BusyForDuration		= 2000 ; don't accept any AI for this long... ai commands will be queued
		WhichSpecialWeapon	= 3
		MustFinishAbility		= Yes
		FreezeAfterTriggerDuration = 2000 ; Hold AI for this long after we fire.
  	ParalyzeDurationWhenCompleted = 500	;Once the unit SUCCESSFULLY COMPLETES an ability, paralyze unit briefly to deal with animation transitions.
  	ParalyzeDurationWhenAborted = 1000	;If the unit ABORTS the ability, paralyze the unit briefly to deal with animation transitions.
	End

	Behavior = SpecialPowerModule ModuleTag_ScreamStarter                      
		SpecialPowerTemplate      = SpecialAbilityBalrogScream
		UpdateModuleStartsAttack  = Yes
		;InitiateSound           = 
	End
	Behavior = ModelConditionSpecialAbilityUpdate ModuleTag_ScreamUpdate   ; So the difference in SpecialPower is that it takes timing from this UpdateG, instead of simply firing.
		SpecialPowerTemplate    = SpecialAbilityBalrogScream
		UnpackTime              = 1500 ; Drawing the horn
		PreparationTime         = 1   ; nothing
		PackTime                = 1800 ; Putting horn away
		AwardXPForTriggering    = 0
		WhichSpecialPower = 1
		MustFinishAbility		= Yes
		FreezeAfterTriggerDuration = 2000 ; Hold AI for this long after we fire.
  	ParalyzeDurationWhenCompleted = 500	;Once the unit SUCCESSFULLY COMPLETES an ability, paralyze unit briefly to deal with animation transitions.
  	ParalyzeDurationWhenAborted = 1000	;If the unit ABORTS the ability, paralyze the unit briefly to deal with animation transitions.
	End

	Behavior = SpecialPowerModule ModuleTag_BreathStarter                      
		SpecialPowerTemplate		= SpecialAbilityBalrogBreath
		UpdateModuleStartsAttack	= Yes
		InitiateSound			= BalrogSpecialPowerRoar	;this plays on right-click target, not when Balrog leaps
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_BreathUpdate   
		SpecialPowerTemplate    = SpecialAbilityBalrogBreath
		; SkipContinue			= Yes
		UnpackTime              = 1300 ; Drawing the horn
		PackTime                = 3700 ; Putting horn away
		AwardXPForTriggering    = 0
		StartAbilityRange = 40.0
		SpecialWeapon = MordorBalrogBreath
		WhichSpecialWeapon = 1
		MustFinishAbility		= Yes
		FreezeAfterTriggerDuration = 2000 ; Hold AI for this long after we fire.
  	ParalyzeDurationWhenCompleted = 500	;Once the unit SUCCESSFULLY COMPLETES an ability, paralyze unit briefly to deal with animation transitions.
  	ParalyzeDurationWhenAborted = 1000	;If the unit ABORTS the ability, paralyze the unit briefly to deal with animation transitions.
	End

	Behavior = SpecialPowerModule ModuleTag_LeapStarter                      
		SpecialPowerTemplate		= SpecialAbilityBalrogWings
		UpdateModuleStartsAttack	= Yes
		InitiateSound			= BalrogSpecialPowerRoar	;this plays on right-click target, not when Balrog leaps
		StartsPaused			= No
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_LeapUpdate   
		; SkipContinue			= Yes
		SpecialPowerTemplate    = SpecialAbilityBalrogWings
		UnpackTime              = 1733 ; Drawing the horn
		PackTime                = 1160 ; Putting horn away
		AwardXPForTriggering    = 0
		StartAbilityRange	= 800.0
		ApproachRequiresLOS = No
		SpecialWeapon		= MordorBalrogLeap
    FreezeAfterTriggerDuration 	= 1000 ; Hold AI for this long after we fire.
		BusyForDuration		= 4000 ; don't accept any AI for this long... ai commands will be queued
		WhichSpecialWeapon	= 2
		MustFinishAbility		= Yes
		FreezeAfterTriggerDuration = 2000 ; Hold AI for this long after we fire.
  	ParalyzeDurationWhenCompleted = 500	;Once the unit SUCCESSFULLY COMPLETES an ability, paralyze unit briefly to deal with animation transitions.
  	ParalyzeDurationWhenAborted = 1000	;If the unit ABORTS the ability, paralyze the unit briefly to deal with animation transitions.
	End

	
	Behavior = CreateObjectDie ModuleTag_CrushUnitsOnDeath
		CreationList = OCL_BalrogDie
 	End
 	
 	Behavior = RadiateFearUpdate ModuleTag_FearMeForIAmTheBalrog //SEE
		EmotionPulseRadius		= 300
		EmotionPulseInterval		= 1000
		GenerateFear				= Yes
		GenerateTerror			= Yes
		InitiallyActive				= Yes
		VictimFilter				= ALL ENEMIES ALLIES -HERO
	End

	;///////////////////
	; Autoabilities
	;///////////////////

	Behavior = AutoAbilityBehavior ModuleTag_SpecialAbilityFireWhipAutoAbility
		SpecialAbility				= SpecialAbilityFireWhip
		MaxScanRange				= 275
		Query								= 1 ANY ENEMIES +HERO +MONSTER +MACHINE -STRUCTURE
	End
	
	Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityRoar	
		SpecialAbility				= SpecialAbilityBalrogScream				// Use this ability
		MaxScanRange				= 90
		Query						= 10 ANY +INFANTRY +CAVALRY -MACHINE -IMMOBILE -DOZER -HERO -STRUCTURE -BASE_FOUNDATION -DwarvenBattleWagon -RohanOathbreaker -MordorRamCrew -MONSTER ENEMIES
	End

	Behavior = AutoAbilityBehavior ModuleTag_BalrogBreathAutoAbility
		SpecialAbility	= SpecialAbilityBalrogBreath
		Query			= 10 ANY ENEMIES +INFANTRY +CAVALRY				; then a group of guys
		Query			= 1 ANY ENEMIES	+STRUCTURE							; then anything
	End		

	Behavior = AutoAbilityBehavior ModuleTag_LeapAutoAbility
		SpecialAbility	= SpecialAbilityBalrogWings
		; StartsActive				= Yes											; Active immediately.
		MaxScanRange				= 800
		MinScanRange				= 250											; Target must be further away than this.
		Query			= 2 ANY ENEMIES +MACHINE			; first check for some machines
		Query			= 15 ANY ENEMIES +INFANTRY +CAVALRY	+ARCHER		; then a group of guys
		Query			= 1 ANY ENEMIES	 +COMMANDCENTER +HERO	; then a group of guys
	End		

  Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehavior
	End

	;///////////////////
	; AISpecialPowers
	;///////////////////
  
	Behavior = AISpecialPowerUpdate FireWhipAI1
		CommandButtonName = Command_SpecialAbilityFireWhip
		SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER_RANGED
    SpecialPowerRange = 275
	End

	Behavior = AISpecialPowerUpdate FireWhipAI2
		CommandButtonName = Command_SpecialAbilityFireWhip
		SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK ;AI_SPECIAL_POWER_ENEMY_TYPE_KILLER_RANGED
    SpecialPowerRange = 275
	End

	Behavior = AISpecialPowerUpdate BalrogWingsAI
		CommandButtonName = Command_SpecialAbilityBalrogWings
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER ;AI_SPECIAL_POWER_RANGED_AOE_ATTACK
		SpecialPowerRadius = 50
    SpecialPowerRange = 780
	End

	Behavior = AISpecialPowerUpdate BalrogBreathAI1
		CommandButtonName = Command_SpecialAbilityBalrogBreath
		SpecialPowerAIType = AI_SPELLBOOK_STRUCTURE_BREAKER
		SpecialPowerRadius = 100
    SpecialPowerRange = 100
	End
	
	Behavior = AISpecialPowerUpdate BalrogBreathAI2
		CommandButtonName = Command_SpecialAbilityBalrogBreath
		SpecialPowerAIType = AI_SPELLBOOK_ARMY_BREAKER
		SpecialPowerRadius = 100
    SpecialPowerRange = 100
	End
	
	Behavior = AISpecialPowerUpdate IgniteAI
		CommandButtonName = Command_SpecialAbilityIgnite
		SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF ;AI_SPECIAL_POWER_CHARGE
		SpecialPowerRadius = 100
    SpecialPowerRange = 100
	End

  Behavior = AISpecialPowerUpdate BalrogScreamAI
    CommandButtonName = Command_SpecialAbilityBalrogScream
    SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
		SpecialPowerRadius = 50
    SpecialPowerRange = 50
  End

	Geometry			= CYLINDER
	GeometryMajorRadius = 30.0
	GeometryHeight		= 70.0
	GeometryIsSmall		= No
	Shadow				= SHADOW_VOLUME ;SHADOW_DECAL	; SHADOW_VOLUME has trouble with his wings.  Possibly because of the transparent bits
	ShadowSizeX			= 100
	ShadowSizeY			= 100
	ShadowTexture		= ShadowI
End
