; ####################################################
; "Battle for Middle Earth II - Special Extended Edition - Director's Cut"
; ####################################################

; WildGoblinKing.INI for MORIA (Wild) faction... (This is Azog in S.E.E.)
; WildGoblinKingMounted is @ 1550!
; ------------------------------------------------------------------------------
; NOTE: Keep this organized!


Object WildGoblinKing

	SelectPortrait = HPGorkilGoblinKing
	ButtonImage = HIGoblinKing
	
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_GoblinKing
    
	Draw = W3DScriptedModelDraw ModuleTag_DRAW

		WadingParticleSys 	= EntRipples
		StaticModelLODMode 	= Yes ; Will append M or L to the skin name depending on GameLOD
		OkToChangeModelColor	= No //Yes

		; Goblin King on foot
		DefaultModelConditionState
			Model					= WUGobKng_SKN
			Skeleton				= WUGobKng_SKL
		End

		; Mounted Goblin King on Warg
		ModelConditionState			= MOUNTED
			Model					= WUggWarg_SKN
			Skeleton				= IUWARGRIDR_SKL
		End
		
		; Goblin King on foot
		ModelConditionState			= USER_9
			Model					= WUGobKng_SKN
			Skeleton				= WUGobKng_SKL
			ParticleSysBone     = NONE MoriaSpellbookScurry
		End

		; Mounted Goblin King on Warg
		ModelConditionState			= MOUNTED USER_9
			Model					= WUggWarg_SKN
			Skeleton				= IUWARGRIDR_SKL
			ParticleSysBone     = NONE MoriaSpellbookScurry
		End 				

		; -------------- STUNNED ANIMS ----------------
		AnimationState						= MOUNTED PASSENGER
			Animation						= Grabbed
				AnimationName				= IUWARGRIDR_GBDA
				AnimationMode				= LOOP
			End
		End
		
		AnimationState						= MOUNTED FREEFALL
			Animation						= freefall
				AnimationName				= IUWARGRIDR_FLYA
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
			Animation						= freefall
				AnimationName				= IUWARGRIDR_FLYB
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
			Animation						= freefall
				AnimationName				= IUWARGRIDR_FLYC
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
		End
		
		AnimationState = MOUNTED STUNNED_FLAILING 
			Animation				=	JustDie
				AnimationName       	=	IUWARGRIDR_FLYA
				AnimationMode       	=	LOOP
			End
			Animation				=	JustDie
				AnimationName       	=	IUWARGRIDR_FLYB
				AnimationMode       	=	LOOP
			End
			Animation				=	JustDie
				AnimationName       	=	IUWARGRIDR_FLYC
				AnimationMode       	=	LOOP
			End
		End

		AnimationState = MOUNTED DYING BURNINGDEATH
			Animation
				AnimationName		=	IUWARGRIDR_DIEA
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
			End
			Animation
				AnimationName		=	IUWARGRIDR_DIEB
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
			End
			Animation
				AnimationName		=	IUWARGRIDR_DIEC
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
			End
			ParticleSysBone     = BAT_HEADO FireSmall FollowBone:yes 
			ParticleSysBone     = BAT_HEADO FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone     = BAT_SPINE2O FireSmall FollowBone:yes
			ParticleSysBone     = BAT_SPINE2O FireBuildingLargeSmoke FollowBone:yes 
			ParticleSysBone     = BAT_PELVISO FireSmall FollowBone:yes
			ParticleSysBone     = BAT_PELVISO FireBuildingLargeSmoke FollowBone:yes 	
			ParticleSysBone     = BAT_SPINE1W FireSmall FollowBone:yes					//The Warg's back /Naz
			ParticleSysBone     = BAT_SPINE1W FireBuildingLargeSmoke FollowBone:yes		 				
		End
		
		AnimationState				=	MOUNTED DYING SPLATTED
			Animation				=	splatted
				AnimationName		=	IUWARGRIDR_LNDA
				AnimationMode		=	ONCE
			End
			FXEvent	= Frame:2 Name:FX_HorseBodyGroundHit_SEE ;FX_SplatDust
		End
		
		

		AnimationState				=	MOUNTED DYING
			Animation				=	JustDie
				AnimationName		=	IUWARGRIDR_DIEA
				AnimationMode		=	ONCE
			End
			Animation				=	JustDie
				AnimationName		=	IUWARGRIDR_DIEB
				AnimationMode		=	ONCE
			End
			Animation				=	JustDie
				AnimationName		=	IUWARGRIDR_DIEC
				AnimationMode		=	ONCE
			End
		End		
		
		AnimationState				=	MOUNTED STUNNED_STANDING_UP
			Animation				=	StandUp
				AnimationName       	=	IUWARGRIDR_GTPA
				AnimationMode       	=	ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End
		
		AnimationState				=	MOUNTED STUNNED 
			Animation				=	Land
				AnimationName       	=	IUWARGRIDR_LNDA
				AnimationMode       	=	ONCE
			End
		End
		
		AnimationState				= MOUNTED BURNINGDEATH
			Animation
				AnimationName		= IUWARGRIDR_MFDA
				AnimationMode		= ONCE
				Distance				= 50
			End
			Animation
				AnimationName		= IUWARGRIDR_MFDB
				AnimationMode		= ONCE
				Distance				= 50
			End
			Flags = RESTART_ANIM_WHEN_COMPLETE RANDOMSTART
			ParticleSysBone     = BAT_HEADO FireSmall FollowBone:yes 
			ParticleSysBone     = BAT_HEADO FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone     = BAT_SPINE2O FireSmall FollowBone:yes
			ParticleSysBone     = BAT_SPINE2O FireBuildingLargeSmoke FollowBone:yes 
			ParticleSysBone     = BAT_PELVISO FireSmall FollowBone:yes
			ParticleSysBone     = BAT_PELVISO FireBuildingLargeSmoke FollowBone:yes 	
			ParticleSysBone     = BAT_SPINE1W FireSmall FollowBone:yes					//The Warg's back /Naz
			ParticleSysBone     = BAT_SPINE1W FireBuildingLargeSmoke FollowBone:yes				
		End

		AnimationState						= MOUNTED PARALYZED
			Animation
				AnimationName				= IUWARGRIDR_IDLC
				AnimationMode				= LOOP
			End
		End
		
				; battle frenzy anim
		AnimationState				= MOUNTED USER_1
			Animation
				AnimationName		= IUWARGRIDR_CHRB
				AnimationMode		= ONCE
			End
		End

		; call from deep anim
		AnimationState				= MOUNTED  USER_2
			Animation
				AnimationName		= IUWARGRIDR_ATND
				AnimationMode		= ONCE
			End
		End

		; --- Poisoned Stinger Weapon anim
		AnimationState				= MOUNTED SPECIAL_WEAPON_ONE
			Animation
				AnimationName		= IUWARGRIDR_ATKA
				AnimationMode		= ONCE
				UseWeaponTiming		= Yes
			End
			ParticleSysBone B_S_TAIL06 GoblinKingPoison FollowBone:Yes
			ParticleSysBone B_S_TAIL06 GoblinKingPoison2 FollowBone:Yes
		End


		; --- Skull Totem anim
		AnimationState				= MOUNTED PACKING_TYPE_1
			StateName				= STATE_PlantingTotem
			Animation
				AnimationName		= IUWARGRIDR_PNTB
				AnimationMode		= ONCE
			End
			;FXEvent	= Frame:20 FireWhenSkipped Name:FX_GoblinKingTotem
		End

		; -------------- MOVING ANIMS ---------------
		

		AnimationState  = MOUNTED COMING_OUT_OF_FACTORY
			Animation = Being_Built
				AnimationName		= IUWARGRIDR_RUNA
				AnimationMode		= LOOP
				AnimationBlendTime	= 0
			End
		End		
		
		AnimationState				=	MOUNTED TURN_LEFT_HIGH_SPEED  
			Animation				=	MTurnLeft
				AnimationName		=	IUWARGRIDR_TNL1
				AnimationMode		=	LOOP
			End
		End

		AnimationState				=	MOUNTED TURN_RIGHT_HIGH_SPEED
			Animation				=	MTurnRight
				AnimationName		=	IUWARGRIDR_TNR1
				AnimationMode		=	LOOP
			End
		End
		
		AnimationState				=	MOUNTED TURN_LEFT  
			Animation				=	TurnRight
				AnimationName		=	IUWARGRIDR_TRNL
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange = 2.0 2.0
			End
		End

		AnimationState				=	MOUNTED TURN_RIGHT 
			Animation				=	TurnRight
				AnimationName		=	IUWARGRIDR_TRNR
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange = 2.0 2.0
			End
		End

		AnimationState = MOUNTED MOVING FIRING_OR_PREATTACK_A
			Animation = TrotAndFire
				AnimationName = IUWARGRIDR_ATRA
				AnimationMode = LOOP
			End
			Animation = TrotAndFire
				AnimationName = IUWARGRIDR_ATRB
				AnimationMode = LOOP
			End
			Animation = TrotAndFire
				AnimationName = IUWARGRIDR_ATRC
				AnimationMode = LOOP
			End
			Flags = RANDOMSTART
			ParticleSysBone = None CalvaryDustTrails  		//SEE wants dust when cavalry is moving! (Naz)
	    End

      AnimationState				=	MOUNTED MOVING ACCELERATE 
			Animation				=	Accelerate
				AnimationName		=	IUWARGRIDR_ACCL
				AnimationMode		=	ONCE
			End
;            ParticleSysBone				= None GenericSiegeTrailDust
		End
	
		AnimationState				=	MOUNTED DECELERATE
			Animation				=	Decelerate
				AnimationName		=	IUWARGRIDR_DECL
				AnimationMode		=	ONCE
				AnimationSpeedFactorRange = 0.4 0.4
			End
;            ParticleSysBone				= None GenericSiegeTrailDust
		End
		
		AnimationState				=	MOUNTED MOVING BACKING_UP
			Animation				=	BackingUpA
				AnimationName		=	IUWARGRIDR_BAKA
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange = 3.0 3.0
			End
			Animation				=	BackingUpB
				AnimationName		=	IUWARGRIDR_BAKB
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange = 3.0 3.0
			End
			Animation				=	BackingUpC
				AnimationName		=	IUWARGRIDR_BAKC
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange = 3.0 3.0
			End
		End
		
		AnimationState				=	MOUNTED MOVING ;ATTACKING
			ShareAnimation			=	Yes
			Animation				=	RunA
				AnimationName		=	IUWARGRIDR_RUNA
				AnimationMode		=	LOOP
			End
			ParticleSysBone			=	None CalvaryDustTrails  		//SEE wants dust when cavalry is moving! (Naz)
		End
		
		; AnimationState				=	MOVING
			; ShareAnimation			=	Yes			
			; Animation				=	WalkA
				; AnimationName		=	IUWarg_WLKA
				; AnimationMode		=	LOOP
				; AnimationBlendTime	=	10
				; AnimationPriority   =	5 ;10
				; Distance			=   30
			; End
			; Animation				=	WalkB
				; AnimationName		=	IUWarg_WLKB
				; AnimationMode		=	LOOP
				; AnimationBlendTime	=	5 ;10
				; AnimationPriority   =	3
				; Distance			=   30
			; End
			; Animation				=	WalkC
				; AnimationName		=	IUWarg_WLKC
				; AnimationMode		=	LOOP
				; AnimationBlendTime	=	5 ;10
				; AnimationPriority   =	3
				; Distance			=   30
			; End
		; End
    
		; ----------- ATTACKING ANIMS --------------		
		AnimationState				=	MOUNTED BETWEEN_FIRING_SHOTS_A
			Animation				=	BetweenFiringShots
				AnimationName		=	IUWARGRIDR_IDLA
				AnimationMode		=	LOOP
				AnimationBlendTime	=   10
			End
		End

		AnimationState				=	MOUNTED FIRING_OR_PREATTACK_A
			Animation				=	AttackA3
				AnimationName		=	IUWARGRIDR_ATKA
				AnimationMode		=	ONCE
				UseWeaponTiming		=	Yes
				AnimationBlendTime  =	10
			End
		End
		
		AnimationState					= MOUNTED EMOTION_UNCONTROLLABLY_AFRAID
			Animation					= FERA
				AnimationName			= IUWARGRIDR_FERA
				AnimationMode			= LOOP
			End
			Animation					= FERB
				AnimationName			= IUWARGRIDR_FERB
				AnimationMode			= LOOP
			End
			Animation					= FERC
				AnimationName			= IUWARGRIDR_FERC
				AnimationMode			= LOOP
			End
		End
				
		AnimationState				=	MOUNTED ATTACKING
			Animation				=	AttackA3
				AnimationName		=	IUWARGRIDR_IDLA ;IUWARGRIDR_ATKA
				AnimationMode		=	LOOP
				AnimationBlendTime  =	10
			End
			Animation				=	AttackA3
				AnimationName		=	IUWARGRIDR_IDLA ;IUWARGRIDR_ATKD
				AnimationMode		=	LOOP
				AnimationBlendTime  =	10
			End
		End

//		; ----------- WAR CHANT ANIMS ------------- UNUSED!
//		AnimationState = MOUNTED WAR_CHANT
//			Animation = Chant
//				AnimationName = IUWARGRIDR_TNTA
//				AnimationMode = LOOP
//			End
//		End

		; ----------- EMOTION ANIMS ---------------
		AnimationState					= MOUNTED EMOTION_ALERT EMOTION_AFRAID
			Animation					= Apprehensive
				AnimationName			= IUWARGRIDR_APPA
				AnimationMode			= LOOP	;Change this to ONCE if adding additional anims
			End
		End
		
		AnimationState					= MOUNTED EMOTION_AFRAID ;coming soon
			Animation					= FERA
				AnimationName			= IUWARGRIDR_FERA
				AnimationMode			= LOOP
			End
			Animation					= FERB
				AnimationName			= IUWARGRIDR_FERB
				AnimationMode			= LOOP
			End
			Animation					= FERC
				AnimationName			= IUWARGRIDR_FERC
				AnimationMode			= LOOP
			End
		End
				
		AnimationState					= MOUNTED EMOTION_TAUNTING
			Animation					= TNTA
				AnimationName			= IUWARGRIDR_TNTA
				AnimationMode			= LOOP
			End
			Animation					= TNTB
				AnimationName			= IUWARGRIDR_TNTB
				AnimationMode			= LOOP
			End
			Animation					= TNTC
				AnimationName			= IUWARGRIDR_TNTC
				AnimationMode			= LOOP
			End
			Flags					= RANDOMSTART	
		End
		AnimationState					= MOUNTED EMOTION_POINTING
			Animation					= Pointing1A
				AnimationName			= IUWARGRIDR_PNTA
				AnimationMode			= LOOP
			End
			Animation					= Pointing1B
				AnimationName			= IUWARGRIDR_PNTB
				AnimationMode			= LOOP
			End
			Animation					= Pointing1C
				AnimationName			= IUWARGRIDR_PNTC
				AnimationMode			= LOOP
			End
			Flags					= RANDOMSTART	
		End
		AnimationState					= MOUNTED EMOTION_CELEBRATING
			Animation                   = CHRA
				AnimationName			= IUWARGRIDR_CHRA
				AnimationMode			= ONCE
			End
			Animation                   = CHRB
				AnimationName			= IUWARGRIDR_CHRB
				AnimationMode			= ONCE
			End
			Animation                   = CHRC
				AnimationName			= IUWARGRIDR_CHRC
				AnimationMode			= ONCE
			End
			Flags					= RANDOMSTART
		End
		
		; ----------- IDLE ANIMS ---------------
		AnimationState							= MOUNTED EMOTION_ALERT
			StateName							= STATE_Ready 
			Animation							= ALERT
				AnimationName					= IUWargRidr_IDLA
				AnimationMode					= LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Selected" then CurDrawableSetTransitionAnimState("Selected_to_Ready") end
			EndScript	
		End
		
		AnimationState					= MOUNTED RAISING_FLAG
			Animation
				AnimationName			= IUWARGRIDR_CHRA
				AnimationMode			= LOOP
			End
			Animation
				AnimationName			= IUWARGRIDR_CHRB
				AnimationMode			= LOOP
			End
			Animation
				AnimationName			= IUWARGRIDR_CHRC
				AnimationMode			= LOOP
			End
		End

		; ----------- SELECTED ANIMS --------------
		AnimationState				=	MOUNTED SELECTED
			SimilarRestart			=   Yes
			Animation				=	AtAttention
				AnimationName		=	IUWARGRIDR_ATNB
				AnimationMode		=	LOOP
			End
			StateName				= Selected
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("Idle_to_Selected") end
				if Prev == "STATE_Ready" then CurDrawableSetTransitionAnimState("Ready_to_Selected") end
			EndScript
		End

		AnimationState = MOUNTED
			Animation
				AnimationName		=	IUWARGRIDR_IDLC
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
				AnimationPriority   =	20
			End
			Animation
				AnimationName		=	IUWARGRIDR_IDLD
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
				AnimationPriority   =	1
			End
			Animation
				AnimationName		=	IUWARGRIDR_IDLE
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
				AnimationPriority   =	1
			End
			StateName				= Idle 
			AllowRepeatInRandomPick = Yes
			Flags = RESTART_ANIM_WHEN_COMPLETE	
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Selected" then CurDrawableSetTransitionAnimState("Selected_to_Idle") end
			EndScript
		End

		;------------ TRANSITION ANIMS ----------------
		TransitionState       = Selected_to_Idle
			Animation           = ATNE
				AnimationName		=	IUWARGRIDR_ATNE
				AnimationMode		=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End
		
		TransitionState       = Idle_to_Selected
			Animation           = ATND
				AnimationName     = IUWARGRIDR_ATND
				AnimationMode   =	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End

		TransitionState       = Ready_to_Selected
			Animation           = ATNC
				AnimationName     = IUWARGRIDR_ATNC
				AnimationMode   =	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End

		TransitionState       = Selected_to_Ready
			Animation           = ATNCReverse
				AnimationName     = IUWARGRIDR_ATNC
				AnimationMode   =	ONCE_BACKWARDS
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End
		
//	End
	
//	Draw = W3DScriptedModelDraw DustEffects
//	    DefaultModelConditionState
//	      Model = None
//	    End
//	    IdleAnimationState
//	    End
//	    AnimationState = MOVING WADING
//			ParticleSysBone = None FootstepSlash
//	    End
//	    AnimationState = MOVING ACCELERATE
//			ParticleSysBone = None GenericSiegeTrailDust
//	    End
//	    AnimationState = MOVING DECELERATE
//			ParticleSysBone = None GenericSiegeTrailDust
//	    End
//	    AnimationState = MOVING
//	    End
//	End
		
		
//		TransitionState				=	TRANS_SelectFromIdleMounted
//			Animation
//				AnimationName		=	WUGbkMnt_ATNA
//				AnimationMode		=	ONCE
//			End
//		End
//		TransitionState				=	TRANS_SelectFromSkullTotemMounted
//			Animation
//				AnimationName		=	WUGbkMnt_ATNB
//				AnimationMode		=	ONCE
//				AnimationBlendTime	=	0
//			End
//		End
//		TransitionState				=	TRANS_SelectFromMovingMounted
//			Animation
//				AnimationName		=	WUGbkMnt_ATNB
//				AnimationMode		=	ONCE
//			End
//		End
//
//
//		TransitionState				=	TRANS_IdleFromSelectMountedNoBlend
//			Animation
//				AnimationName		=	WUGbkMnt_ATNC
//				AnimationMode		=	ONCE
//				AnimationBlendTime	=	0
//			End
//		End
//		TransitionState				=	TRANS_IdleFromSelectMounted
//			Animation
//				AnimationName		=	WUGbkMnt_ATNC
//				AnimationMode		=	ONCE
//			End
//		End

		IdleAnimationState
			Animation
				AnimationName = WuGobKng_IDLB
				AnimationMode = ONCE
				AnimationPriority = 100
			End
			Animation
				AnimationName = WuGobKng_IDLC
				AnimationMode = ONCE
				AnimationPriority = 5
			End	
			Animation
				AnimationName = WuGobKng_IDLD
				AnimationMode = ONCE
				AnimationPriority = 5
			End	
			StateName = Idle
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_PlantingTotem" then
					CurDrawableSetTransitionAnimState("TRANS_TotemToIdle")
				elseif Prev == "STATE_Selected" then
					CurDrawableSetTransitionAnimState("TRANS_SelectedToBored")
				end
			EndScript
		End


		AnimationState						= PASSENGER
			Animation
				AnimationName				= WuGobKng_FLYA
				AnimationMode				= LOOP
			End
		End
		
		AnimationState						= FREEFALL
			Animation
				AnimationName				= WuGobKng_FLYA
				AnimationMode				= LOOP
				AnimationSpeedFactorRange	= 0.5	0.5
				AnimationBlendTime			= 5
			End
		End
		
		AnimationState			= STUNNED_FLAILING
			Animation
				AnimationName   = WuGobKng_FLYA
				AnimationMode   = LOOP
				AnimationSpeedFactorRange	= 0.4 0.6
			End
		End

		AnimationState			= DYING BURNINGDEATH
			Animation
				AnimationName	= WuGobKng_DTHA
				AnimationMode	= ONCE
				AnimationBlendTime = 10
			End
		End

		AnimationState			= DYING SPLATTED
			Animation
				AnimationName	= WuGobKng_LNDA
				AnimationMode	= ONCE
			End
		End

		AnimationState = DYING
			Animation
				AnimationName = WuGobKng_DTHA
				AnimationMode = ONCE
			End
		End    

		AnimationState			= BURNINGDEATH
			Animation
				AnimationName	= WUGobKNG_MFDA
				AnimationMode	= LOOP
				Distance		= 120
			End
			Flags	= RANDOMSTART
		End

		AnimationState						= PARALYZED
			Animation
				AnimationName				= WuGobKng_IDLA
				AnimationMode				= LOOP
			End
		End


		AnimationState        = STUNNED
			Animation
				AnimationName     = WuGobKng_LNDA
				AnimationMode     = ONCE
			End
		End

		AnimationState        = STUNNED_STANDING_UP
			Animation
				AnimationName     = WuGobKng_GTPA
				AnimationMode     = ONCE
			End
		End	
			
		AnimationState        = THROWN_PROJECTILE
			Animation
				AnimationName     = WuGobKng_FLYA
				AnimationMode     = LOOP
			End
		End

	     
		AnimationState = MOVING WANDER
			Animation
				AnimationName = WuGobKng_WLKA
				AnimationMode = LOOP
			End
		End

		AnimationState = MOVING DAMAGED AFLAME
			Animation
				AnimationName = WuGobKng_MFDA
				AnimationMode = LOOP
			End
			Flags = RANDOMSTART
		End

		AnimationState = MOVING ATTACKING
			Animation
				AnimationName = WuGobKng_RUNA
				AnimationMode = LOOP
			End
			Flags = RANDOMSTART
			ParticleSysBone = None InfantryDustTrails
		End

		AnimationState = MOVING WALKING
			Animation
				AnimationName = WuGobKng_WLKA
				AnimationMode = LOOP
			End
			Flags = RANDOMSTART
			ParticleSysBone = None InfantryDustTrails
		End

		AnimationState = MOVING
			Animation
				AnimationName = WuGobKng_RUNA
				AnimationMode = LOOP
			End
			Flags = RANDOMSTART
			ParticleSysBone = None InfantryDustTrails
		End
	    
		AnimationState = PACKING_TYPE_1
			StateName = STATE_PlantingTotem
			Animation
				AnimationName = WuGobKng_SPCC
				AnimationMode = ONCE
			End
			FXEvent	= Frame:20 FireWhenSkipped Name:FX_GoblinKingTotem
		End

		; --------- Click and Hit Reactions ------------
		; battle frenzy anim
		AnimationState				= USER_1
			Animation
				AnimationName		= WuGobKng_SPCA
				AnimationMode		= ONCE
			End
		End

		; call from deep anim
		AnimationState				= USER_2
			Animation
				AnimationName		= WuGobKng_SPCB
				AnimationMode		= ONCE
			End
		End


		AnimationState = HIT_REACTION 
			Animation
				AnimationName = WuGobKng_HITA
				AnimationMode = LOOP
			End
		End
			
		AnimationState = FIRING_OR_PREATTACK_A
			Animation
				AnimationName = WuGobKng_ATKA
				AnimationMode = ONCE
				UseWeaponTiming		=	Yes
			End
			Animation
				AnimationName = WuGobKng_ATKB
				AnimationMode = ONCE
				UseWeaponTiming		=	Yes
			End
		End
		
		AnimationState = FIRING_OR_PREATTACK_B
			Animation
				AnimationName = WuGobKng_ATKA
				AnimationMode = ONCE
				UseWeaponTiming		=	Yes
			End
			Animation
				AnimationName = WuGobKng_ATKB
				AnimationMode = ONCE
				UseWeaponTiming		=	Yes
			End
		End

		AnimationState = BETWEEN_FIRING_SHOTS_A
			Animation
				AnimationName = WuGobKng_IDLA
				AnimationMode = ONCE
			End
		End

		AnimationState = ATTACKING
			Animation
				AnimationName = WuGobKng_ATKA
				AnimationMode = LOOP
			End
			Animation
				AnimationName = WuGobKng_ATKB //Added for SEE!
				AnimationMode = LOOP
			End
		End
	    
		AnimationState							= EMOTION_TAUNTING
			Animation
				AnimationName					= WuGobKng_TNTA
				AnimationMode					= LOOP
				AnimationBlendTime				= 10
			End
			Flags				= RESTART_ANIM_WHEN_COMPLETE
		End
		
		AnimationState				=	MOUNTED EMOTION_CELEBRATING
			Animation
				AnimationName		=	WUGbkMnt_CHRA
				AnimationMode		=	LOOP
			End
		End
		
		AnimationState							= EMOTION_CELEBRATING
			Animation
				AnimationName					= WuGobKng_CHRA
				AnimationMode					= ONCE
				AnimationBlendTime				= 10
			End
			Flags				= RESTART_ANIM_WHEN_COMPLETE
		End

		AnimationState				= LEVELED
			Animation				= LevelUp
				AnimationName		= WuGobKng_LVLA
				AnimationMode		= ONCE
			End
		End

		AnimationState							= RAISING_FLAG
			Animation
				AnimationName					= WuGobKng_CHRA
				AnimationMode					= LOOP
			End
		End

		AnimationState        = SELECTED
			StateName           = STATE_Selected
			Animation
				AnimationName     = WuGobKng_ATNB
				AnimationMode     = LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_PlantingTotem" then
					CurDrawableSetTransitionAnimState("TRANS_TotemToIdle")
				elseif Prev ~= "STATE_Selected" and Prev ~= "TRANS_IdleToSelected" then
					CurDrawableSetTransitionAnimState("TRANS_IdleToSelected")
				end
			EndScript
		End

		

		TransitionState       = TRANS_IdleToSelected
			Animation
				AnimationName     = WuGobKng_ATNA
				AnimationMode     = ONCE
			End
		End

		TransitionState		= TRANS_SelectedToBored
			Animation
				AnimationName	= WuGobKng_ATNC
				AnimationMode	= ONCE
			End
		End
		
		TransitionState		= TRANS_TotemToIdle
			Animation
				AnimationName		= WuGobKng_IDLA
				AnimationMode		= ONCE
				AnimationBlendTime	= 0
			End
		End
	
	End


	Draw = W3DScriptedModelDraw DustEffects
	    DefaultModelConditionState
	      Model = None
	    End
	    IdleAnimationState
	    End
	    AnimationState = MOUNTED MOVING WADING
			ParticleSysBone = None FootstepSlash
	    End
	    AnimationState = MOUNTED MOVING ACCELERATE
			ParticleSysBone = None CalvaryDustTrails //GenericSiegeTrailDust
	    End
	    AnimationState = MOUNTED MOVING DECELERATE
			ParticleSysBone = None CalvaryDustTrails //GenericSiegeTrailDust
	    End
	    AnimationState = DISGUISED MOUNTED MOVING ACCELERATE
			ParticleSysBone = None CalvaryDustTrails //GenericSiegeTrailDust
	    End
	    AnimationState = DISGUISED MOUNTED MOVING DECELERATE
			ParticleSysBone = None CalvaryDustTrails //GenericSiegeTrailDust
	    End
	    AnimationState = MOUNTED MOVING
			ParticleSysBone = None CalvaryDustTrails
	    End
        AnimationState = DISGUISED MOUNTED MOVING
			ParticleSysBone = None CalvaryDustTrails
        End
	End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"

	; ***DESIGN parameters ***
	Side = Wild
	EditorSorting = UNIT
	ThreatLevel = GOBLIN_KING_THREAT_LEVEL
	ThreatBreakdown Unit_DetailedThreat
		AIKindOf = HERO
	End
	
	ThingClass = CHARACTER_UNIT
	TransportSlotCount 	= TRANSPORTSLOTCOUNT_HERO
	BuildCost           = WILD_GOBLIN_KING_BUILDCOST
	BuildTime           = HERO_INITIAL_BUILDTIME
	ShockwaveResistance 	= SHOCKWAVE_RESISTANCE_STANDARD ;M_SHOCKWAVE_RESISTANCE_STRONG	
	BountyValue         	= WILD_GOBLIN_KING_BOUNTY_VALUE
	Scale 				= 1.15 //15% bigger!	

; ------------------------------------------------------------------------------
	WeaponSet
		Conditions			= None 
		Weapon				= PRIMARY		GoblinKingBlade
		Weapon				= SECONDARY	GoblinKingBlade
		OnlyAgainst			= SECONDARY	STRUCTURE
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
; ------------------------------------------------------------------------------
	ArmorSet
		Conditions      	= None
		Armor          	= HeroArmor
		DamageFX       	= NormalDamageFX
	End
	ArmorSet
		Conditions      	= MOUNTED
		Armor          	= HeroArmorMounted
		DamageFX       	= NormalDamageFX
	End
; ------------------------------------------------------------------------------		

	VisionRange = VISION_HERO_STANDARD				
	ShroudClearingRange = SHROUD_CLEAR_HERO	
	
	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 1.0%

	DisplayName = OBJECT:WildGoblinKing
	RecruitText 		= CONTROLBAR:WildGoblinKingRecruit	; Anyone who gets revived should get these
	ReviveText		= CONTROLBAR:WildGoblinKingRevive	;;
	Hotkey			= CONTROLBAR:WildGoblinKingHotkey	; If not, it won't look too bad.
	CrusherLevel 			= 0			;Can I crush anything? (Not mounted)
	MountedCrusherLevel 	= 1 //2		;Crush level when mounted.
	CrushableLevel 		= 2			;What am I?:        0 = for infantry, 1 = for trees, 2 = cavalry/heroes
	MountedCrushableLevel = 2			;Crusable level when mounted.

	CrushWeapon		= WargCrush //HeroCrush  

	MinCrushVelocityPercent = 50 ; Has to be moving at at least 50% of full speed.
	CrushDecelerationPercent =20 ; Lose 10 percent of max velocity when crushing.
	
	CrushKnockback = 40
	CrushZFactor = 1.0

	CommandSet = WildGoblinKingCommandSet
	CommandPoints = 00


	; *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Hero
	AutoResolveCombatChain = AutoResolve_HeroCombatChain
	AutoResolveLeadership = AutoResolve_GoblinKingBonus
	AutoResolveBody = AutoResolve_GoblinKingBody
	
	AutoResolveArmor
		Armor = AutoResolve_GoblinKingArmor
	End
	AutoResolveWeapon
		Weapon = AutoResolve_GoblinKingWeapon
	End


	; ******************************************* AUDIO Parameters ***********************************;

	VoiceAttack						= GoblinKingVoiceAttack
	VoiceAttackCharge				= GoblinKingVoiceAttackCharge
	VoiceAttackMachine				= GoblinKingVoiceAttack
	VoiceAttackStructure				= GoblinKingVoiceAttackBuilding
	VoiceFear						= GoblinKingVoiceHelpMe
	VoiceGuard						= GoblinKingVoiceMove
	VoiceMove						= GoblinKingVoiceMove
	VoiceMoveOverWalls				= GoblinKingVoiceMove
	VoiceMoveToCamp					= GoblinKingVoiceMoveCamp
	VoiceMoveWhileAttacking			= GoblinKingVoiceDisengage
	VoicePriority						= 88
	VoiceRetreatToCastle				= GoblinKingVoiceRetreat
	VoiceSelect						= GoblinKingVoiceSelectMS
	VoiceSelectBattle 					= GoblinKingVoiceSelectBattle

	SoundImpact						= ImpactHorse

	UnitSpecificSounds
		VoiceEnterUnitEvilMenTransportShip	= GoblinKingVoiceMoveShip
		VoiceEnterUnitMordorMumakil		= GoblinKingVoiceMoveGarrison
		VoiceEnterUnitSlaughterHouse		= GoblinKingVoiceMoveGarrison
		VoiceGarrison						= GoblinKingVoiceMoveGarrison
		VoiceInitiateCaptureBuilding		= GoblinKingVoiceCaptureBuilding
	End

	ClientBehavior = ModelConditionSoundSelectorClientBehavior ModuleTag_MCSoundSelector
		SoundState = MOUNTED
			VoiceMove		= GoblinKingVoiceMove //GoblinKingVoiceMoveMountedMS (has scorpion sounds)
			VoiceSelect		= GoblinKingVoiceSelectMS //GoblinKingVoiceSelectMountedMS (has scorpion sounds)
			SoundMoveLoop		= WargMoveFootsteps //ScorpionMoveLoop (has scorpion sounds)
			SoundAmbient		= WargAmbienceVOX
			;SoundCrushing		= WargRiderCrushing 	; Sound made when crushing another unit underhoof
		End
	End

	CrowdResponseKey = Goblin

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
	EvaEventDieOwner		= GoblinKingDie			;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU			; Tie into LargeGroupAudio system
		Key = Goblin Hero
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800

		;AnimationSound = Sound:GoblinKingPoisonStingerStrike	Animation:WUGbkMnt_SKL.WUGbkMnt_ATKB	Frames:4
		AnimationSound = Sound:BodyFallOrc					Animation:WUGOBKNG_SKL.WUGOBKNG_DTHA	Frames:73
		AnimationSound = Sound:BodyFallOrc					Animation:WUGOBKNG_SKL.WUGOBKNG_LNDA	Frames:5

		;--- mounted ---
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_RUNA 	Frames:0
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNL1 	Frames:0
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNR1 	Frames:0
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TRNL 	Frames:0
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TRNR 	Frames:0
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_ACCL 	Frames:0

		AnimationSound = Sound:WargRiderTauntCallouts 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA 	Frames:27

		AnimationSound = Sound:WargTauntCallouts 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA 	Frames:26
		AnimationSound = Sound:WargTauntCallouts 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_ATND 	Frames:7 
		AnimationSound = Sound:WargTauntCallouts 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_HWLA 	Frames:17
		AnimationSound = Sound:WargTauntFootstep 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA 	Frames:7 12 64 73

		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA 	Frames:25 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_RUNA 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNL1 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNR1 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_ACCL 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_ATNA 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_ATND 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_GTPA 	Frames:5 101 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_HWLA 	Frames:15 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_RDYA 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_RDYB 	Frames:5

		AnimationSound = Sound:BuildingWargPitRiderDrop	Animation:IUWARGRIDR_SKL.IUWARGRIDR_BLDB	Frames:44

		AnimationSound = Sound:BodyFallOrc		 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_DIEB	Frames:10
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:IUWARGRIDR_SKL.IUWARGRIDR_DIEB	Frames:45
		AnimationSound = Sound:BodyFallOrc		 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_LNDA	Frames:1 17

		AnimationSound = Sound:BodyFallGeneric1		Animation:IUWARGRIDR_SKL.IUWARGRIDR_DIEC	Frames:16				;rider falls
		AnimationSound = Sound:BodyFallGeneric1		Animation:IUWARGRIDR_SKL.IUWARGRIDR_DIEC	Frames:30				;warg falls
		;AnimationSound = Sound:	Animation:IUWARGRIDR_SKL.IUWARGRIDR_CHRB	Frames:37 43	;rears up, growls then drops back down
		AnimationSound = Sound:WargTauntCallouts	Animation:IUWARGRIDR_SKL.IUWARGRIDR_PNTC	Frames:7 22				;warg barks twice
		AnimationSound = Sound:WargTauntCallouts	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTB	Frames:6 21 34 56 70	;barking
		AnimationSound = Sound:WargTauntCallouts	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTC	Frames:7 44				;growling
	End	

	;-------------------------------------------------------------

	; *** ENGINEERING Parameters ***

	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance				= 200
		TauntAndPointUpdateDelay			= 10000
		PointAt							= ANY +HERO
		AddEmotion			=	Terror_Base
		AddEmotion			=	Doom_Base
		//	AddEmotion			=   BraceForBeingCrushed_Base
		AddEmotion			=	UncontrollableFear_Base
		//	AddEmotion			=	FearIdle_Base
		//	AddEmotion			=	FearBusy_Base
		AddEmotion			=	Point_Base
		AddEmotion			=	Taunt_Base
 		AddEmotion			=	CheerIdle_Base
		AddEmotion			=	CheerBusy_Base
		//	AddEmotion			=	HeroCheerIdle_Base
		//	AddEmotion			=	HeroCheerBusy_Base
		AddEmotion			=	Alert_Base
		AddEmotion			=	CheerForAboutToCrush_Base
	End

	RadarPriority = UNIT
	KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY ATTACK_NEEDS_LINE_OF_SIGHT PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY HEAVY_MELEE_HITTER
	PathfindDiameter = 10.0 ;40.0

	Body = RespawnBody ModuleTag_RespawnBody
		MaxHealth         		= WILD_GOBLIN_KING_HEALTH  ;BALANCE Goblin King Health
		PermanentlyKilledByFilter	= NONE		;Who kills me permanently?
		DodgePercent      		= HERO_DODGE_PERCENT
		BurningDeathBehavior 		= Yes
		BurningDeathFX       	= FX_InfantryBurningFlame
	End

	Behavior = RespawnUpdate ModuleTag_RespawnUpdate
		; DeathAnim				= STUNNED					;Model condition to play when killed-to-respawn
		DeathFX					= FX_GoblinKingDieToRespawn	;FXList to play when killed-to-respawn
		DeathAnim				= DYING						;Model condition to play when killed-to-respawn
		DeathAnimationTime		= 6500						;How long DeathAnim will take.
		InitialSpawnFX			= FX_GoblinKingInitialSpawn
		RespawnAnim				= LEVELED					;Animation to play when respawning.
		RespawnFX				= FX_GoblinKingRespawn		;FXList to play when respawning.
		RespawnAnimationTime		= 2000						;Time it takes for respawn to play.
		AutoRespawnAtObjectFilter	= NONE +CASTLE_KEEP			;Respawn at this location -- and at it's exit production point if possible.
		ButtonImage				= HIGoblinKing_res
		;RespawnEntries determine the ruleset for how a character can be revived. Some units may automatically respawn, others
		;may require a specific revive action performed on him. You can specify different values for each level... or use Level:Any
		RespawnRules = AutoSpawn:No Cost:HERO_RESPAWN_COST_LO	 Time:HERO_RESPAWN_TIME Health:100%		;DEFAULT VALUES
	End

	Behavior = AutoHealBehavior ModuleTag_GoblinKingHealing
		StartsActive 		= Yes
		HealingAmount 		= HERO_HEAL_AMOUNT
		HealingDelay 			= 1000
		StartHealingDelay 		= HERO_HEAL_DELAY
		HealOnlyIfNotInCombat = Yes
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
	End
	
	Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehavior
	End		
	
; ¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤ 	
	Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
		LevelToGrant	= 10
		MPOnly = Yes ;No
	End
; ¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤ 	

	;-----------------------------------------------------------------------------
	;	Leadership
	;-----------------------------------------------------------------------------	
	Behavior = AttributeModifierAuraUpdate ModuleTag_HeroLeadership
		StartsActive 	= Yes ;If no, requires upgrade to turn on.
		BonusName 		= GenericHeroLeadership
		RefreshDelay 		= 2500
		Range 			= 200
		ObjectFilter	= WILD_GOBLINKING_BUFF_RECIPIENT_OBJECT_FILTER
	End

	;--------------------------------------------  

	Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
	End

	#include "..\..\..\includes\CaptureBuilding.inc"
	
	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle 	= Yes ;ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 500
		BurningDeathTime		   		= BURNINGDEATH_DURATION_INFANTRY
		AILuaEventsList				= BaseHeroFunctions
	End

	LocomotorSet
		Locomotor 	= HeroHumanLocomotor
		Condition		= SET_NORMAL 
		Speed     	= NORMAL_EVIL_HERO_SPEED
	End
	LocomotorSet
		Locomotor 	= WargLocomotor //GoblinKingLocomotor	//HeroHorseLocomotor
		Condition 	= SET_MOUNTED 
		Speed     	= NORMAL_ISENGARD_CAVALRY_FAST_MEMBER_SPEED //81
	End
	LocomotorSet
		Locomotor 	= BurningDeathLocomotorInfantry
		Condition 	= SET_BURNINGDEATH
		Speed	  	= BURNINGDEATH_WANDERSPEED_INFANTRY
	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
		ShockStandingTime = 4500	;msec
	End
	 
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes 		= ALL
		SinkDelay 		= 60000 //3000
		SinkRate 		= 0.40 //1.40     ; in Dist/Sec
		DestructionDelay 	= 90000 //8000
		Sound = INITIAL GoblinKingVoiceDie
	End
	
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End
	
	Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
	End

	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
		HitReactionLifeTimer1 = 1800	// level 1 (light  damage)  hit reaction animations in ms
		HitReactionThreshold1 = 5.0   // level 1 (light  damage) threshold trigger	
		FastHitsResetReaction = No		// If set -- when hits occur faster than the reaction animations, it will reset the animation. (like getting riddled with machine gun bullets)
	End


	;-----------------------------------------------------------------------------
	;	Mount/Dismount 
	;-----------------------------------------------------------------------------	
 ;	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ScorpionToggleEnabler
;		SpecialPowerTemplate = SpecialAbilityToggleMounted
;;		;TriggeredBy = Upgrade_ObjectLevel3
;	End;;
;
;	Behavior = SpecialPowerModule ModuleTag_ScorpionToggleStarter
 ;		SpecialPowerTemplate    = SpecialAbilityToggleMounted
; 		UpdateModuleStartsAttack	= Yes
; 		StartsPaused 			= No //Yes
; 	End
;
;	Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_ScorpionToggle
 ;		SpecialPowerTemplate   	= SpecialAbilityToggleMounted
 ;		UnpackTime             	= 2000
 ;		PreparationTime         	= 1  
 ;		PersistentPrepTime      	= 250
 ;		PackTime				= 2000	
 ;		OpacityTarget			= .3		; How see-thru to be at peak of change
 ;		AwardXPForTriggering		= 0
	;End
	
	;---------MOUNT------------------------------------------------------------------------
 	Behavior = SpecialPowerModule ModuleTag_HorseToggleStarter                      
 		SpecialPowerTemplate		= SpecialAbilityToggleMounted
 		UpdateModuleStartsAttack	= Yes
 		StartsPaused				= No
		;InitiateSound				= FellBeastVoiceMove
 	End

	Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_HorseToggle
 		SpecialPowerTemplate    = SpecialAbilityToggleMounted
 		MountedTemplate			= WildGoblinKingMounted
 		SynchronizeTimerOnSpecialPower = SpecialAbilityCurseEnemy SpecialAbilityScreech
 		UnpackTime              = 2000
 		PreparationTime         = 0			; none, cause we hop onto our mount in no time at all :)
 		PackTime                = 0 		; none, cause we hop onto our mount in no time at all :)
 		OpacityTarget			= .0		; How see-thru to be at peak of change
 		AwardXPForTriggering    = 0
 		IgnoreFacingCheck		= Yes
		;TriggerSound			= FellBeastVoiceMove
	End
	
	;-----------------------------------------------------------------------------
	;	Call from the Deep, aka Spawn Fire Drakes
	;-----------------------------------------------------------------------------
	;Behavior = UnpauseSpecialPowerUpgrade ModuleTag_CallFromTheDeepEnabler
	;	SpecialPowerTemplate = SpecialAbilityCallFromTheDeep
	;	;TriggeredBy = Upgrade_ObjectLevel10
	;End
	;
	;Behavior = OCLSpecialPower ModuleTag_CallFromTheDeepPower
	;	SpecialPowerTemplate	= SpecialAbilityCallFromTheDeep
	;	OCL						= OCL_WildFireDrakeEgg
	;	CreateLocation			= CREATE_AT_LOCATION
	;	StartsPaused				= Yes
	;	TriggerFX			 	= FX_DrakeSummon
	;	SetModelCondition			= ModelConditionState:USER_2
	;	SetModelConditionTime		= 3.5
	;	DisableDuringAnimDuration 	= Yes
	;End
	
	
	;-----------------------------------------------------------------------------
	;	Skull Totem
	;-----------------------------------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SkullTotemEnabler
		SpecialPowerTemplate	= SpecialAbilitySkullTotem
		;TriggeredBy				= Upgrade_ObjectLevel2
	End

	Behavior = SpecialPowerModule ModuleTag_SkullTotemStarter
 		SpecialPowerTemplate	= SpecialAbilitySkullTotem
 		UpdateModuleStartsAttack	= Yes
 		StartsPaused				= No ;Yes
		InitiateSound				= GoblinKingVoiceSkullTotem
		OnTriggerRechargeSpecialPower	= SpecialAbilityMountedSkullTotem
 	End

	Behavior = ActivateModuleSpecialPower ModuleTag_SkullTotemUpdate
 		SpecialPowerTemplate    = SpecialAbilitySkullTotem
		StartAbilityRange			= 25
		MustFinishAbility			= Yes
 		UnpackTime              = 800
 		PackTime                = 1200		
 		UnpackingVariation			= 1										; sets PACKING_TYPE_1
		TriggerSpecialPower		= ModuleTag_SkullTotemPower2 OBJECTPOS
	End

	Behavior = OCLSpecialPower ModuleTag_SkullTotemPower2
		SpecialPowerTemplate	= SpecialAbilitySkullTotem2
		OCL						= OCL_SpawnSkullTotem				;OCL_SkullTotemEgg
		CreateLocation			= CREATE_AT_LOCATION
		StartsPaused			= No
	End
	
	;-----------------------------------------------------------------------------
	;	Mounted Skull Totem - same as unmounted but uses a different offset and timings
	;-----------------------------------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MountedSkullTotemEnabler
		SpecialPowerTemplate	= SpecialAbilityMountedSkullTotem
		;TriggeredBy				= Upgrade_ObjectLevel2
	End

	Behavior = SpecialPowerModule ModuleTag_MountedSkullTotemStarter
 		SpecialPowerTemplate		= SpecialAbilityMountedSkullTotem
 		UpdateModuleStartsAttack		= Yes
 		StartsPaused					= Yes
		OnTriggerRechargeSpecialPower	= SpecialAbilitySkullTotem
 	End

	Behavior = ActivateModuleSpecialPower ModuleTag_MountedSkullTotemUpdate
 		SpecialPowerTemplate    = SpecialAbilityMountedSkullTotem
		StartAbilityRange			= 25
		MustFinishAbility			= Yes
 		UnpackTime              = 1300
 		PackTime                = 1000
 		UnpackingVariation			= 1										; sets PACKING_TYPE_1
		TriggerSpecialPower		= ModuleTag_MountedSkullTotemPower2 OBJECTPOS
	End

	Behavior = OCLSpecialPower ModuleTag_MountedSkullTotemPower2
		SpecialPowerTemplate	= SpecialAbilityMountedSkullTotem2
		OCL						= OCL_SpawnMountedSkullTotem
		CreateLocation			= CREATE_AT_LOCATION
		StartsPaused			= No
	End	

	;--------------------------------

;	Behavior = MonitorConditionUpdate ModueTag_CommandSetSwapper
;		WeaponSetFlags			= MOUNTED
;		WeaponToggleCommandSet	= MountedWildGoblinKingCommandSet
;	End
	
	; Moria Scurry!
	Behavior = AttributeModifierUpgrade ModuleTag_ScurryBonus
		TriggeredBy = Upgrade_MoriaScurry
		AttributeModifier = SpellBookMoriaScurry
	End


	;///////////////////
	; AISpecialPowers
	;///////////////////

	#include "..\..\..\..\SEE_includes\Battlestance_SEE.inc"

  #include "..\..\..\..\SEE_includes\HeroAIInjuredBehavior_SEE.inc"

	Behavior = AISpecialPowerUpdate GoblinKingMountAI
		CommandButtonName = Command_GoblinKingMountScorpion
		SpecialPowerAIType = AI_SPECIAL_POWER_GOBLINKING_MOUNTED
	End
	
	Behavior = AISpecialPowerUpdate TotemAI
		CommandButtonName = Command_GoblinKingSkullTotem
		SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
	End	

	Behavior = AISpecialPowerUpdate GoblinKingCallOfTheDeepAI
		CommandButtonName = Command_GoblinKingCallFromTheDeep //Command_GoblinKingCallOfTheDeep
		SpecialPowerAIType = AI_SPECIAL_POWER_GOBLINKING_CALLOFTHEDEEP
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate GoblinKingPoisonedStingerAI
		CommandButtonName = Command_GoblinKingPoisonedStinger
		SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
		; SpecialPowerRadius = 100
	End

	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes
	Shadow = SHADOW_DECAL
	ShadowSizeX = 20;
	ShadowSizeY = 20;
	ShadowTexture = ShadowI;
End

;------------------------------------------------------------------------------
Object WildSkullTotem
	
	SelectPortrait = BPGCamp_Plot

	Draw = W3DScriptedModelDraw ModuleTag_Draw
	
		DefaultModelConditionState
			Model               = WUGobKng_Totem
			ParticleSysBone = None TaintHCPing HouseColor:yes
			ParticleSysBone = None GoblinKingTaint
			

				Shadow =  SHADOW_ALPHA_DECAL_DYNAMIC; SHADOW_ADDITIVE_DECAL_DYNAMIC
				ShadowSizeX = 200;
				ShadowSizeY = 200;
				ShadowTexture = EXTaint;
				
				ShadowOpacityStart = 0
				ShadowOpacityFadeInTime = 1000
				ShadowOpacityPeak = 175
				ShadowOpacityFadeOutTime = 1000
				ShadowOpacityEnd = 0
				ShadowOverrideLODVisibility = YES
		End
		
	

	End

	; ***DESIGN parameters ***
	DisplayName			= OBJECT:SkullTotem
	EditorSorting		= MISC_MAN_MADE
	Side				= Wild
	ShroudClearingRange	= SHROUD_CLEAR_SKULL_TOTEM
	KindOf				= STRUCTURE IMMOBILE SELECTABLE IGNORE_FOR_VICTORY ;NOT_AUTOACQUIRABLE
	;Shadow				= SHADOW_VOLUME
	RadarPriority		= UNIT
	
	Body            = ActiveBody ModuleTag_Body
		MaxHealth	= SKULL_TOTEM_HEALTH
	End

	Behavior = DestroyDie ModuleTagDeath_Die
		DeathTypes = ALL
	End

	Behavior = StealthDetectorUpdate ModuleTag_DetectStealth
		DetectionRate	= SKULL_TOTEM_STEALTH_DETECT_RATE			; how often to rescan for stealthed things in my sight (msec)
		DetectionRange	= SKULL_TOTEM_STEALTH_DETECT_RADIUS			; enable this for independant balancing!
				ExtraRequiredKindOf   = SELECTABLE ; WE DON'T GET TO SEE FRODO'S OBJECTIVE
	End
	
	Behavior = AttributeModifierAuraUpdate ModuleTag_Leadership
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= GenericArmorLeadership ; ;GenericHeroLeadership
		RefreshDelay		= 2000
		Range			= 200
		; AntiCategory	= BUFF
		ObjectFilter	= WILD_GOBLINKING_BUFF_RECIPIENT_OBJECT_FILTER
	End

	Geometry			= CYLINDER
	GeometryMajorRadius	= 5.0
	GeometryHeight		= 20.0
	GeometryIsSmall		= No
	BuildCompletion		= PLACED_BY_PLAYER
	GeometryContactPoint = X:0.0	Y:0.0		Z:0
	GeometryContactPoint = X:0.0	Y:0.0		Z:20.0		Swoop
	
End

//The goblin bitch :D

Object WildGoblinKingMounted

	SelectPortrait = HPGorkilGoblinKing
	ButtonImage = HIGoblinKing
	
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_GoblinKing
    
	Draw = W3DScriptedModelDraw ModuleTag_DRAW

		WadingParticleSys 	= EntRipples
		StaticModelLODMode 	= Yes ; Will append M or L to the skin name depending on GameLOD
		OkToChangeModelColor	= No //Yes

		; Mounted Goblin King on Warg
		DefaultModelConditionState
			Model					= WUggWarg_SKN
			Skeleton				= IUWARGRIDR_SKL
		End

		; Mounted Goblin King on Warg
		ModelConditionState			= USER_9
			Model					= WUggWarg_SKN
			Skeleton				= IUWARGRIDR_SKL
			ParticleSysBone     = NONE MoriaSpellbookScurry
		End 				

		; -------------- STUNNED ANIMS ----------------
		AnimationState						= PASSENGER
			Animation						= Grabbed
				AnimationName				= IUWARGRIDR_GBDA
				AnimationMode				= LOOP
			End
		End
		
		AnimationState						= FREEFALL
			Animation						= freefall
				AnimationName				= IUWARGRIDR_FLYA
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
			Animation						= freefall
				AnimationName				= IUWARGRIDR_FLYB
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
			Animation						= freefall
				AnimationName				= IUWARGRIDR_FLYC
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
		End
		
		AnimationState = STUNNED_FLAILING 
			Animation				=	JustDie
				AnimationName       	=	IUWARGRIDR_FLYA
				AnimationMode       	=	LOOP
			End
			Animation				=	JustDie
				AnimationName       	=	IUWARGRIDR_FLYB
				AnimationMode       	=	LOOP
			End
			Animation				=	JustDie
				AnimationName       	=	IUWARGRIDR_FLYC
				AnimationMode       	=	LOOP
			End
		End

		AnimationState = DYING BURNINGDEATH
			Animation
				AnimationName		=	IUWARGRIDR_DIEA
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
			End
			Animation
				AnimationName		=	IUWARGRIDR_DIEB
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
			End
			Animation
				AnimationName		=	IUWARGRIDR_DIEC
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
			End
			ParticleSysBone     = BAT_HEADO FireSmall FollowBone:yes 
			ParticleSysBone     = BAT_HEADO FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone     = BAT_SPINE2O FireSmall FollowBone:yes
			ParticleSysBone     = BAT_SPINE2O FireBuildingLargeSmoke FollowBone:yes 
			ParticleSysBone     = BAT_PELVISO FireSmall FollowBone:yes
			ParticleSysBone     = BAT_PELVISO FireBuildingLargeSmoke FollowBone:yes 	
			ParticleSysBone     = BAT_SPINE1W FireSmall FollowBone:yes					//The Warg's back /Naz
			ParticleSysBone     = BAT_SPINE1W FireBuildingLargeSmoke FollowBone:yes		 				
		End
		
		AnimationState				=	DYING SPLATTED
			Animation				=	splatted
				AnimationName		=	IUWARGRIDR_LNDA
				AnimationMode		=	ONCE
			End
			FXEvent	= Frame:2 Name:FX_HorseBodyGroundHit_SEE ;FX_SplatDust
		End
		
		

		AnimationState				=	DYING
			Animation				=	JustDie
				AnimationName		=	IUWARGRIDR_DIEA
				AnimationMode		=	ONCE
			End
			Animation				=	JustDie
				AnimationName		=	IUWARGRIDR_DIEB
				AnimationMode		=	ONCE
			End
			Animation				=	JustDie
				AnimationName		=	IUWARGRIDR_DIEC
				AnimationMode		=	ONCE
			End
		End		
		
		AnimationState				=	STUNNED_STANDING_UP
			Animation				=	StandUp
				AnimationName       	=	IUWARGRIDR_GTPA
				AnimationMode       	=	ONCE
				AnimationSpeedFactorRange = 1.5 1.5
			End
		End
		
		AnimationState				=	STUNNED 
			Animation				=	Land
				AnimationName       	=	IUWARGRIDR_LNDA
				AnimationMode       	=	ONCE
			End
		End
		
		AnimationState				= BURNINGDEATH
			Animation
				AnimationName		= IUWARGRIDR_MFDA
				AnimationMode		= ONCE
				Distance				= 50
			End
			Animation
				AnimationName		= IUWARGRIDR_MFDB
				AnimationMode		= ONCE
				Distance				= 50
			End
			Flags = RESTART_ANIM_WHEN_COMPLETE RANDOMSTART
			ParticleSysBone     = BAT_HEADO FireSmall FollowBone:yes 
			ParticleSysBone     = BAT_HEADO FireBuildingLargeSmoke FollowBone:yes
			ParticleSysBone     = BAT_SPINE2O FireSmall FollowBone:yes
			ParticleSysBone     = BAT_SPINE2O FireBuildingLargeSmoke FollowBone:yes 
			ParticleSysBone     = BAT_PELVISO FireSmall FollowBone:yes
			ParticleSysBone     = BAT_PELVISO FireBuildingLargeSmoke FollowBone:yes 	
			ParticleSysBone     = BAT_SPINE1W FireSmall FollowBone:yes					//The Warg's back /Naz
			ParticleSysBone     = BAT_SPINE1W FireBuildingLargeSmoke FollowBone:yes				
		End

		AnimationState						= PARALYZED
			Animation
				AnimationName				= IUWARGRIDR_IDLC
				AnimationMode				= LOOP
			End
		End
		
				; battle frenzy anim
		AnimationState				= USER_1
			Animation
				AnimationName		= IUWARGRIDR_CHRB
				AnimationMode		= ONCE
			End
		End

		; call from deep anim
		AnimationState				= USER_2
			Animation
				AnimationName		= IUWARGRIDR_ATND
				AnimationMode		= ONCE
			End
		End

		; --- Poisoned Stinger Weapon anim
		AnimationState				= SPECIAL_WEAPON_ONE
			Animation
				AnimationName		= IUWARGRIDR_ATKA
				AnimationMode		= ONCE
				UseWeaponTiming		= Yes
			End
			ParticleSysBone B_S_TAIL06 GoblinKingPoison FollowBone:Yes
			ParticleSysBone B_S_TAIL06 GoblinKingPoison2 FollowBone:Yes
		End


		; --- Skull Totem anim
		AnimationState				= PACKING_TYPE_1
			StateName				= STATE_PlantingTotem
			Animation
				AnimationName		= IUWARGRIDR_PNTB
				AnimationMode		= ONCE
			End
			;FXEvent	= Frame:20 FireWhenSkipped Name:FX_GoblinKingTotem
		End

		; -------------- MOVING ANIMS ---------------
		

		AnimationState  = COMING_OUT_OF_FACTORY
			Animation = Being_Built
				AnimationName		= IUWARGRIDR_RUNA
				AnimationMode		= LOOP
				AnimationBlendTime	= 0
			End
		End		
		
		AnimationState				=	TURN_LEFT_HIGH_SPEED  
			Animation				=	MTurnLeft
				AnimationName		=	IUWARGRIDR_TNL1
				AnimationMode		=	LOOP
			End
		End

		AnimationState				=	TURN_RIGHT_HIGH_SPEED
			Animation				=	MTurnRight
				AnimationName		=	IUWARGRIDR_TNR1
				AnimationMode		=	LOOP
			End
		End
		
		AnimationState				=	TURN_LEFT  
			Animation				=	TurnRight
				AnimationName		=	IUWARGRIDR_TRNL
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange = 2.0 2.0
			End
		End

		AnimationState				=	TURN_RIGHT 
			Animation				=	TurnRight
				AnimationName		=	IUWARGRIDR_TRNR
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange = 2.0 2.0
			End
		End

		AnimationState = MOVING FIRING_OR_PREATTACK_A
			Animation = TrotAndFire
				AnimationName = IUWARGRIDR_ATRA
				AnimationMode = LOOP
			End
			Animation = TrotAndFire
				AnimationName = IUWARGRIDR_ATRB
				AnimationMode = LOOP
			End
			Animation = TrotAndFire
				AnimationName = IUWARGRIDR_ATRC
				AnimationMode = LOOP
			End
			Flags = RANDOMSTART
			ParticleSysBone = None CalvaryDustTrails  		//SEE wants dust when cavalry is moving! (Naz)
	    End

      AnimationState				=	MOVING ACCELERATE 
			Animation				=	Accelerate
				AnimationName		=	IUWARGRIDR_ACCL
				AnimationMode		=	ONCE
			End
;            ParticleSysBone				= None GenericSiegeTrailDust
		End
	
		AnimationState				=	DECELERATE
			Animation				=	Decelerate
				AnimationName		=	IUWARGRIDR_DECL
				AnimationMode		=	ONCE
				AnimationSpeedFactorRange = 0.4 0.4
			End
;            ParticleSysBone				= None GenericSiegeTrailDust
		End
		
		AnimationState				=	MOVING BACKING_UP
			Animation				=	BackingUpA
				AnimationName		=	IUWARGRIDR_BAKA
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange = 3.0 3.0
			End
			Animation				=	BackingUpB
				AnimationName		=	IUWARGRIDR_BAKB
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange = 3.0 3.0
			End
			Animation				=	BackingUpC
				AnimationName		=	IUWARGRIDR_BAKC
				AnimationMode		=	LOOP
				AnimationSpeedFactorRange = 3.0 3.0
			End
		End
		
		AnimationState				=	MOVING
			ShareAnimation			=	Yes
			Animation				=	RunA
				AnimationName		=	IUWARGRIDR_RUNA
				AnimationMode		=	LOOP
			End
			ParticleSysBone			=	None CalvaryDustTrails  		//SEE wants dust when cavalry is moving! (Naz)
		End
    
		; ----------- ATTACKING ANIMS --------------		
		AnimationState				=	BETWEEN_FIRING_SHOTS_A
			Animation				=	BetweenFiringShots
				AnimationName		=	IUWARGRIDR_IDLA
				AnimationMode		=	LOOP
				AnimationBlendTime	=   10
			End
		End

		AnimationState				=	FIRING_OR_PREATTACK_A
			Animation				=	AttackA3
				AnimationName		=	IUWARGRIDR_ATKA
				AnimationMode		=	ONCE
				UseWeaponTiming		=	Yes
				AnimationBlendTime  =	10
			End
		End
		
		AnimationState					= EMOTION_UNCONTROLLABLY_AFRAID
			Animation					= FERA
				AnimationName			= IUWARGRIDR_FERA
				AnimationMode			= LOOP
			End
			Animation					= FERB
				AnimationName			= IUWARGRIDR_FERB
				AnimationMode			= LOOP
			End
			Animation					= FERC
				AnimationName			= IUWARGRIDR_FERC
				AnimationMode			= LOOP
			End
		End
				
		AnimationState				=	ATTACKING
			Animation				=	AttackA3
				AnimationName		=	IUWARGRIDR_IDLA ;IUWARGRIDR_ATKA
				AnimationMode		=	LOOP
				AnimationBlendTime  =	10
			End
			Animation				=	AttackA3
				AnimationName		=	IUWARGRIDR_IDLA ;IUWARGRIDR_ATKD
				AnimationMode		=	LOOP
				AnimationBlendTime  =	10
			End
		End

		; ----------- EMOTION ANIMS ---------------
		AnimationState					= EMOTION_ALERT EMOTION_AFRAID
			Animation					= Apprehensive
				AnimationName			= IUWARGRIDR_APPA
				AnimationMode			= LOOP	;Change this to ONCE if adding additional anims
			End
		End
		
		AnimationState					= EMOTION_AFRAID ;coming soon
			Animation					= FERA
				AnimationName			= IUWARGRIDR_FERA
				AnimationMode			= LOOP
			End
			Animation					= FERB
				AnimationName			= IUWARGRIDR_FERB
				AnimationMode			= LOOP
			End
			Animation					= FERC
				AnimationName			= IUWARGRIDR_FERC
				AnimationMode			= LOOP
			End
		End
				
		AnimationState					= EMOTION_TAUNTING
			Animation					= TNTA
				AnimationName			= IUWARGRIDR_TNTA
				AnimationMode			= LOOP
			End
			Animation					= TNTB
				AnimationName			= IUWARGRIDR_TNTB
				AnimationMode			= LOOP
			End
			Animation					= TNTC
				AnimationName			= IUWARGRIDR_TNTC
				AnimationMode			= LOOP
			End
			Flags					= RANDOMSTART	
		End
		AnimationState					= EMOTION_POINTING
			Animation					= Pointing1A
				AnimationName			= IUWARGRIDR_PNTA
				AnimationMode			= LOOP
			End
			Animation					= Pointing1B
				AnimationName			= IUWARGRIDR_PNTB
				AnimationMode			= LOOP
			End
			Animation					= Pointing1C
				AnimationName			= IUWARGRIDR_PNTC
				AnimationMode			= LOOP
			End
			Flags					= RANDOMSTART	
		End
		AnimationState					= EMOTION_CELEBRATING
			Animation                   = CHRA
				AnimationName			= IUWARGRIDR_CHRA
				AnimationMode			= ONCE
			End
			Animation                   = CHRB
				AnimationName			= IUWARGRIDR_CHRB
				AnimationMode			= ONCE
			End
			Animation                   = CHRC
				AnimationName			= IUWARGRIDR_CHRC
				AnimationMode			= ONCE
			End
			Flags					= RANDOMSTART
		End
		
		; ----------- IDLE ANIMS ---------------
		AnimationState							= EMOTION_ALERT
			StateName							= STATE_Ready 
			Animation							= ALERT
				AnimationName					= IUWargRidr_IDLA
				AnimationMode					= LOOP
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Selected" then CurDrawableSetTransitionAnimState("Selected_to_Ready") end
			EndScript	
		End
		
		AnimationState					= RAISING_FLAG
			Animation
				AnimationName			= IUWARGRIDR_CHRA
				AnimationMode			= LOOP
			End
			Animation
				AnimationName			= IUWARGRIDR_CHRB
				AnimationMode			= LOOP
			End
			Animation
				AnimationName			= IUWARGRIDR_CHRC
				AnimationMode			= LOOP
			End
		End

		; ----------- SELECTED ANIMS --------------
		AnimationState				=	SELECTED
			SimilarRestart			=   Yes
			Animation				=	AtAttention
				AnimationName		=	IUWARGRIDR_ATNB
				AnimationMode		=	LOOP
			End
			StateName				= Selected
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("Idle_to_Selected") end
				if Prev == "STATE_Ready" then CurDrawableSetTransitionAnimState("Ready_to_Selected") end
			EndScript
		End

		IdleAnimationState
			Animation
				AnimationName		=	IUWARGRIDR_IDLC
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
				AnimationPriority   =	20
			End
			Animation
				AnimationName		=	IUWARGRIDR_IDLD
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
				AnimationPriority   =	1
			End
			Animation
				AnimationName		=	IUWARGRIDR_IDLE
				AnimationMode		=	ONCE
				AnimationBlendTime	=	10
				AnimationPriority   =	1
			End
			StateName				= Idle 
			AllowRepeatInRandomPick = Yes
			Flags = RESTART_ANIM_WHEN_COMPLETE	
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Selected" then CurDrawableSetTransitionAnimState("Selected_to_Idle") end
			EndScript
		End

		;------------ TRANSITION ANIMS ----------------
		TransitionState       = Selected_to_Idle
			Animation           = ATNE
				AnimationName		=	IUWARGRIDR_ATNE
				AnimationMode		=	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End
		
		TransitionState       = Idle_to_Selected
			Animation           = ATND
				AnimationName     = IUWARGRIDR_ATND
				AnimationMode   =	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End

		TransitionState       = Ready_to_Selected
			Animation           = ATNC
				AnimationName     = IUWARGRIDR_ATNC
				AnimationMode   =	ONCE
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End

		TransitionState       = Selected_to_Ready
			Animation           = ATNCReverse
				AnimationName     = IUWARGRIDR_ATNC
				AnimationMode   =	ONCE_BACKWARDS
				AnimationSpeedFactorRange = 0.7 1.3
			End
		End
		
		AnimationState				=	EMOTION_CELEBRATING
			Animation
				AnimationName		=	WUGbkMnt_CHRA
				AnimationMode		=	LOOP
			End
		End

		

		TransitionState       = TRANS_IdleToSelected
			Animation
				AnimationName     = WuGobKng_ATNA
				AnimationMode     = ONCE
			End
		End

		TransitionState		= TRANS_SelectedToBored
			Animation
				AnimationName	= WuGobKng_ATNC
				AnimationMode	= ONCE
			End
		End
		
		TransitionState		= TRANS_TotemToIdle
			Animation
				AnimationName		= WuGobKng_IDLA
				AnimationMode		= ONCE
				AnimationBlendTime	= 0
			End
		End
	
	End


	Draw = W3DScriptedModelDraw DustEffects
	    DefaultModelConditionState
	      Model = None
	    End
	    IdleAnimationState
	    End
	    AnimationState = MOVING WADING
			ParticleSysBone = None FootstepSlash
	    End
	    AnimationState = MOVING ACCELERATE
			ParticleSysBone = None CalvaryDustTrails //GenericSiegeTrailDust
	    End
	    AnimationState = MOVING DECELERATE
			ParticleSysBone = None CalvaryDustTrails //GenericSiegeTrailDust
	    End
	    AnimationState = DISGUISED MOVING ACCELERATE
			ParticleSysBone = None CalvaryDustTrails //GenericSiegeTrailDust
	    End
	    AnimationState = DISGUISED MOVING DECELERATE
			ParticleSysBone = None CalvaryDustTrails //GenericSiegeTrailDust
	    End
	    AnimationState = MOVING
			ParticleSysBone = None CalvaryDustTrails
	    End
        AnimationState = DISGUISED MOVING
			ParticleSysBone = None CalvaryDustTrails
        End
	End


    #include "..\..\..\includes\StunDrawModuleSmall.inc"

	; ***DESIGN parameters ***
	Side = Wild
	EditorSorting = UNIT
	ThreatLevel = GOBLIN_KING_THREAT_LEVEL
	ThreatBreakdown Unit_DetailedThreat
		AIKindOf = HERO
	End
	
	ThingClass = CHARACTER_UNIT
	TransportSlotCount 	= TRANSPORTSLOTCOUNT_HERO
	BuildCost           = WILD_GOBLIN_KING_BUILDCOST
	BuildTime           = HERO_INITIAL_BUILDTIME
	ShockwaveResistance 	= SHOCKWAVE_RESISTANCE_STANDARD ;M_SHOCKWAVE_RESISTANCE_STRONG	
	BountyValue         	= WILD_GOBLIN_KING_BOUNTY_VALUE
	Scale 				= 1.05 //5% bigger!	

; ------------------------------------------------------------------------------
	WeaponSet
		Conditions			= None 
		Weapon				= PRIMARY		GoblinKingBlade
		Weapon				= SECONDARY	GoblinKingBlade
		OnlyAgainst			= SECONDARY	STRUCTURE
		AutoChooseSources	= PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
; ------------------------------------------------------------------------------
	ArmorSet
		Conditions      	= None
		Armor          	= HeroArmor
		DamageFX       	= NormalDamageFX
	End
	ArmorSet
		Conditions      	= MOUNTED
		Armor          	= HeroArmorMounted
		DamageFX       	= NormalDamageFX
	End
; ------------------------------------------------------------------------------		

	VisionRange = VISION_HERO_STANDARD				
	ShroudClearingRange = SHROUD_CLEAR_HERO	
	
	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 1.0%

	DisplayName = OBJECT:WildGoblinKing
	RecruitText 		= CONTROLBAR:WildGoblinKingRecruit	; Anyone who gets revived should get these
	ReviveText		= CONTROLBAR:WildGoblinKingRevive	;;
	Hotkey			= CONTROLBAR:WildGoblinKingHotkey	; If not, it won't look too bad.
	CrusherLevel 			= 1			;Can I crush anything? (Not mounted)
	MountedCrusherLevel 	= 1 //2		;Crush level when mounted.
	CrushableLevel 		= 2			;What am I?:        0 = for infantry, 1 = for trees, 2 = cavalry/heroes
	MountedCrushableLevel = 2			;Crusable level when mounted.

	CrushWeapon		= WargCrush //HeroCrush  

	MinCrushVelocityPercent = 50 ; Has to be moving at at least 50% of full speed.
	CrushDecelerationPercent =20 ; Lose 10 percent of max velocity when crushing.
	
	CrushKnockback = 40
	CrushZFactor = 1.0

	CommandSet = MountedWildGoblinKingCommandSet
	CommandPoints = 00


	; *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Hero
	AutoResolveCombatChain = AutoResolve_HeroCombatChain
	AutoResolveLeadership = AutoResolve_GoblinKingBonus
	AutoResolveBody = AutoResolve_GoblinKingBody
	
	AutoResolveArmor
		Armor = AutoResolve_GoblinKingArmor
	End
	AutoResolveWeapon
		Weapon = AutoResolve_GoblinKingWeapon
	End


	; ******************************************* AUDIO Parameters ***********************************;

	VoiceAttack						= GoblinKingVoiceAttack
	VoiceAttackCharge				= GoblinKingVoiceAttackCharge
	VoiceAttackMachine				= GoblinKingVoiceAttack
	VoiceAttackStructure				= GoblinKingVoiceAttackBuilding
	VoiceFear						= GoblinKingVoiceHelpMe
	VoiceGuard						= GoblinKingVoiceMove
	VoiceMove						= GoblinKingVoiceMove
	VoiceMoveOverWalls				= GoblinKingVoiceMove
	VoiceMoveToCamp					= GoblinKingVoiceMoveCamp
	VoiceMoveWhileAttacking			= GoblinKingVoiceDisengage
	VoicePriority						= 88
	VoiceRetreatToCastle				= GoblinKingVoiceRetreat
	VoiceSelect						= GoblinKingVoiceSelectMS
	VoiceSelectBattle 					= GoblinKingVoiceSelectBattle

	SoundImpact						= ImpactHorse
	SoundMoveLoop		= WargMoveFootsteps //ScorpionMoveLoop (has scorpion sounds)
	SoundAmbient		= AzogWargAmbienceVOX //So if wanted one can tweak it :D
	;SoundCrushing		= WargRiderCrushing 	; Sound made when crushing another unit underhoof

	UnitSpecificSounds
		VoiceEnterUnitEvilMenTransportShip	= GoblinKingVoiceMoveShip
		VoiceEnterUnitMordorMumakil		= GoblinKingVoiceMoveGarrison
		VoiceEnterUnitSlaughterHouse		= GoblinKingVoiceMoveGarrison
		VoiceGarrison						= GoblinKingVoiceMoveGarrison
		VoiceInitiateCaptureBuilding		= GoblinKingVoiceCaptureBuilding
	End

	CrowdResponseKey = Goblin

    #include "..\..\..\includes\StandardUnitEvaEvents.inc"
	EvaEventDieOwner		= GoblinKingDie			;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU			; Tie into LargeGroupAudio system
		Key = Goblin Hero
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800

		;AnimationSound = Sound:GoblinKingPoisonStingerStrike	Animation:WUGbkMnt_SKL.WUGbkMnt_ATKB	Frames:4
		AnimationSound = Sound:BodyFallOrc					Animation:WUGOBKNG_SKL.WUGOBKNG_DTHA	Frames:73
		AnimationSound = Sound:BodyFallOrc					Animation:WUGOBKNG_SKL.WUGOBKNG_LNDA	Frames:5

		;--- mounted ---
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_RUNA 	Frames:0
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNL1 	Frames:0
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNR1 	Frames:0
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TRNL 	Frames:0
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TRNR 	Frames:0
		AnimationSound = Sound:WargMoveFootsteps 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_ACCL 	Frames:0

		AnimationSound = Sound:WargRiderTauntCallouts 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA 	Frames:27

		AnimationSound = Sound:WargTauntCallouts 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA 	Frames:26
		AnimationSound = Sound:WargTauntCallouts 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_ATND 	Frames:7 
		AnimationSound = Sound:WargTauntCallouts 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_HWLA 	Frames:17
		AnimationSound = Sound:WargTauntFootstep 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA 	Frames:7 12 64 73

		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTA 	Frames:25 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_RUNA 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNL1 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNR1 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_ACCL 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_ATNA 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_ATND 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_GTPA 	Frames:5 101 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_HWLA 	Frames:15 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_RDYA 	Frames:5 
		AnimationSound = Sound:WargSaddleFoleySingles 	Animation:IUWARGRIDR_SKL.IUWARGRIDR_RDYB 	Frames:5

		AnimationSound = Sound:BuildingWargPitRiderDrop	Animation:IUWARGRIDR_SKL.IUWARGRIDR_BLDB	Frames:44

		AnimationSound = Sound:BodyFallOrc		 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_DIEB	Frames:10
		AnimationSound = Sound:BodyFallGenericNoArmor	Animation:IUWARGRIDR_SKL.IUWARGRIDR_DIEB	Frames:45
		AnimationSound = Sound:BodyFallOrc		 		Animation:IUWARGRIDR_SKL.IUWARGRIDR_LNDA	Frames:1 17

		AnimationSound = Sound:BodyFallGeneric1		Animation:IUWARGRIDR_SKL.IUWARGRIDR_DIEC	Frames:16				;rider falls
		AnimationSound = Sound:BodyFallGeneric1		Animation:IUWARGRIDR_SKL.IUWARGRIDR_DIEC	Frames:30				;warg falls
		;AnimationSound = Sound:	Animation:IUWARGRIDR_SKL.IUWARGRIDR_CHRB	Frames:37 43	;rears up, growls then drops back down
		AnimationSound = Sound:WargTauntCallouts	Animation:IUWARGRIDR_SKL.IUWARGRIDR_PNTC	Frames:7 22				;warg barks twice
		AnimationSound = Sound:WargTauntCallouts	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTB	Frames:6 21 34 56 70	;barking
		AnimationSound = Sound:WargTauntCallouts	Animation:IUWARGRIDR_SKL.IUWARGRIDR_TNTC	Frames:7 44				;growling
	End	

	;-------------------------------------------------------------

	; *** ENGINEERING Parameters ***

	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance				= 200
		TauntAndPointUpdateDelay			= 10000
		PointAt							= ANY +HERO
		AddEmotion			=	Terror_Base
		AddEmotion			=	Doom_Base
		//	AddEmotion			=   BraceForBeingCrushed_Base
		AddEmotion			=	UncontrollableFear_Base
		//	AddEmotion			=	FearIdle_Base
		//	AddEmotion			=	FearBusy_Base
		AddEmotion			=	Point_Base
		AddEmotion			=	Taunt_Base
 		AddEmotion			=	CheerIdle_Base
		AddEmotion			=	CheerBusy_Base
		//	AddEmotion			=	HeroCheerIdle_Base
		//	AddEmotion			=	HeroCheerBusy_Base
		AddEmotion			=	Alert_Base
		AddEmotion			=	CheerForAboutToCrush_Base
	End

	RadarPriority = UNIT
	KindOf = HERO PRELOAD SELECTABLE CAN_CAST_REFLECTIONS INFANTRY ATTACK_NEEDS_LINE_OF_SIGHT PATH_THROUGH_EACH_OTHER SCORE ARMY_SUMMARY HEAVY_MELEE_HITTER
	PathfindDiameter = 10.0 ;40.0

	Body = RespawnBody ModuleTag_RespawnBody
		MaxHealth         		= WILD_GOBLIN_KING_HEALTH  ;BALANCE Goblin King Health
		PermanentlyKilledByFilter	= NONE		;Who kills me permanently?
		DodgePercent      		= HERO_DODGE_PERCENT
		BurningDeathBehavior 		= Yes
		BurningDeathFX       	= FX_InfantryBurningFlame
	End

	Behavior = RespawnUpdate ModuleTag_RespawnUpdate
		; DeathAnim				= STUNNED					;Model condition to play when killed-to-respawn
		DeathFX					= FX_GoblinKingDieToRespawn	;FXList to play when killed-to-respawn
		DeathAnim				= DYING						;Model condition to play when killed-to-respawn
		DeathAnimationTime		= 6500						;How long DeathAnim will take.
		InitialSpawnFX			= FX_GoblinKingInitialSpawn
		RespawnAnim				= LEVELED					;Animation to play when respawning.
		RespawnFX				= FX_GoblinKingRespawn		;FXList to play when respawning.
		RespawnAnimationTime		= 2000						;Time it takes for respawn to play.
		AutoRespawnAtObjectFilter	= NONE +CASTLE_KEEP			;Respawn at this location -- and at it's exit production point if possible.
		ButtonImage				= HIGoblinKing_res

		RespawnAsTemplate			= WildGoblinKing

		;RespawnEntries determine the ruleset for how a character can be revived. Some units may automatically respawn, others
		;may require a specific revive action performed on him. You can specify different values for each level... or use Level:Any
		RespawnRules = AutoSpawn:No Cost:HERO_RESPAWN_COST_LO	 Time:HERO_RESPAWN_TIME Health:100%		;DEFAULT VALUES
	End

	Behavior = AutoHealBehavior ModuleTag_GoblinKingHealing
		StartsActive 		= Yes
		HealingAmount 		= HERO_HEAL_AMOUNT
		HealingDelay 			= 1000
		StartHealingDelay 		= HERO_HEAL_DELAY
		HealOnlyIfNotInCombat = Yes
		UnitHealPulseFX		= FX_SpellHealUnitHealBuff
	End
	
	Behavior = AutoAbilityBehavior ModuleTag_AutoAbilityBehavior
	End		
	
; ¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤ 	
	Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
		LevelToGrant	= 10
		MPOnly = Yes ;No
	End
; ¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤¤ 	

	;-----------------------------------------------------------------------------
	;	Leadership
	;-----------------------------------------------------------------------------	
	Behavior = AttributeModifierAuraUpdate ModuleTag_HeroLeadership
		StartsActive 	= Yes ;If no, requires upgrade to turn on.
		BonusName 		= GenericHeroLeadership
		RefreshDelay 		= 2500
		Range 			= 200
		ObjectFilter	= WILD_GOBLINKING_BUFF_RECIPIENT_OBJECT_FILTER
	End

	;--------------------------------------------  

	Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
	End

	#include "..\..\..\includes\CaptureBuilding.inc"
	
	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle 	= Yes ;ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 500
		BurningDeathTime		   		= BURNINGDEATH_DURATION_INFANTRY
		AILuaEventsList				= BaseHeroFunctions
	End

	LocomotorSet
		Locomotor 	= WargLocomotor
		Condition 	= SET_NORMAL 
		Speed     	= NORMAL_ISENGARD_CAVALRY_FAST_MEMBER_SPEED //81
	End
	LocomotorSet
		Locomotor 	= BurningDeathLocomotorInfantry
		Condition 	= SET_BURNINGDEATH
		Speed	  	= BURNINGDEATH_WANDERSPEED_INFANTRY
	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
		ShockStandingTime = 4500	;msec
	End
	 
	Behavior = SlowDeathBehavior ModuleTag_05
		DeathTypes 		= ALL
		SinkDelay 		= 60000 //3000
		SinkRate 		= 0.40 //1.40     ; in Dist/Sec
		DestructionDelay 	= 90000 //8000
		Sound = INITIAL GoblinKingVoiceDie
	End
	
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End
	
	Behavior = NotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
	End

	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
		HitReactionLifeTimer1 = 1800	// level 1 (light  damage)  hit reaction animations in ms
		HitReactionThreshold1 = 5.0   // level 1 (light  damage) threshold trigger	
		FastHitsResetReaction = No		// If set -- when hits occur faster than the reaction animations, it will reset the animation. (like getting riddled with machine gun bullets)
	End


	;-----------------------------------------------------------------------------
	;	Mount/Dismount 
	;-----------------------------------------------------------------------------	
	;---------DISMOUNT------------------------------------------------------------------------
 	Behavior = SpecialPowerModule ModuleTag_DismountStarter
 		SpecialPowerTemplate		= SpecialAbilityToggleMounted
 		UpdateModuleStartsAttack	= Yes
 		StartsPaused				= No
		InitiateSound				= FellBeastVoiceMove
 	End
	Behavior = ToggleMountedSpecialAbilityUpdate ModuleTag_Dismount
 		SpecialPowerTemplate    = SpecialAbilityToggleMounted
 		StartAbilityRange		= 50.0									; pretty small so we are forced to the right place.
 		MountedTemplate			= WildGoblinKing
 		SynchronizeTimerOnSpecialPower = SpecialAbilityCurseEnemy SpecialAbilityScreech
 		UnpackTime              = 0
 		PreparationTime         = 1  
; 		PersistentPrepTime      = 250
 		PackTime                = 0
 		OpacityTarget			= 1										; How see-thru to be at peak of change
 		AwardXPForTriggering    = 0
 		IgnoreFacingCheck		= Yes
	End
	
	;-----------------------------------------------------------------------------
	;	Skull Totem
	;-----------------------------------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_SkullTotemEnabler
		SpecialPowerTemplate	= SpecialAbilitySkullTotem
		;TriggeredBy				= Upgrade_ObjectLevel2
	End

	Behavior = SpecialPowerModule ModuleTag_SkullTotemStarter
 		SpecialPowerTemplate	= SpecialAbilitySkullTotem
 		UpdateModuleStartsAttack	= Yes
 		StartsPaused				= No ;Yes
		InitiateSound				= GoblinKingVoiceSkullTotem
		OnTriggerRechargeSpecialPower	= SpecialAbilityMountedSkullTotem
 	End

	Behavior = ActivateModuleSpecialPower ModuleTag_SkullTotemUpdate
 		SpecialPowerTemplate    = SpecialAbilitySkullTotem
		StartAbilityRange			= 25
		MustFinishAbility			= Yes
 		UnpackTime              = 800
 		PackTime                = 1200		
 		UnpackingVariation			= 1										; sets PACKING_TYPE_1
		TriggerSpecialPower		= ModuleTag_SkullTotemPower2 OBJECTPOS
	End

	Behavior = OCLSpecialPower ModuleTag_SkullTotemPower2
		SpecialPowerTemplate	= SpecialAbilitySkullTotem2
		OCL						= OCL_SpawnSkullTotem				;OCL_SkullTotemEgg
		CreateLocation			= CREATE_AT_LOCATION
		StartsPaused			= No
	End
	
	;-----------------------------------------------------------------------------
	;	Mounted Skull Totem - same as unmounted but uses a different offset and timings
	;-----------------------------------------------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_MountedSkullTotemEnabler
		SpecialPowerTemplate	= SpecialAbilityMountedSkullTotem
		;TriggeredBy				= Upgrade_ObjectLevel2
	End

	Behavior = SpecialPowerModule ModuleTag_MountedSkullTotemStarter
 		SpecialPowerTemplate		= SpecialAbilityMountedSkullTotem
 		UpdateModuleStartsAttack		= Yes
 		StartsPaused					= Yes
		OnTriggerRechargeSpecialPower	= SpecialAbilitySkullTotem
 	End

	Behavior = ActivateModuleSpecialPower ModuleTag_MountedSkullTotemUpdate
 		SpecialPowerTemplate    = SpecialAbilityMountedSkullTotem
		StartAbilityRange			= 25
		MustFinishAbility			= Yes
 		UnpackTime              = 1300
 		PackTime                = 1000
 		UnpackingVariation			= 1										; sets PACKING_TYPE_1
		TriggerSpecialPower		= ModuleTag_MountedSkullTotemPower2 OBJECTPOS
	End

	Behavior = OCLSpecialPower ModuleTag_MountedSkullTotemPower2
		SpecialPowerTemplate	= SpecialAbilityMountedSkullTotem2
		OCL						= OCL_SpawnMountedSkullTotem
		CreateLocation			= CREATE_AT_LOCATION
		StartsPaused			= No
	End	

	;--------------------------------

	; Moria Scurry!
	Behavior = AttributeModifierUpgrade ModuleTag_ScurryBonus
		TriggeredBy = Upgrade_MoriaScurry
		AttributeModifier = SpellBookMoriaScurry
	End


	;///////////////////
	; AISpecialPowers
	;///////////////////

	#include "..\..\..\..\SEE_includes\Battlestance_SEE.inc"

  #include "..\..\..\..\SEE_includes\HeroAIInjuredBehavior_SEE.inc"

	Behavior = AISpecialPowerUpdate GoblinKingMountAI
		CommandButtonName = Command_GoblinKingMountScorpion
		SpecialPowerAIType = AI_SPECIAL_POWER_GOBLINKING_MOUNTED
	End
	
	Behavior = AISpecialPowerUpdate TotemAI
		CommandButtonName = Command_GoblinKingSkullTotem
		SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
	End	

	Behavior = AISpecialPowerUpdate GoblinKingCallOfTheDeepAI
		CommandButtonName = Command_GoblinKingCallFromTheDeep //Command_GoblinKingCallOfTheDeep
		SpecialPowerAIType = AI_SPECIAL_POWER_GOBLINKING_CALLOFTHEDEEP
		SpecialPowerRadius = 100
	End

	Behavior = AISpecialPowerUpdate GoblinKingPoisonedStingerAI
		CommandButtonName = Command_GoblinKingPoisonedStinger
		SpecialPowerAIType = AI_SPECIAL_POWER_ENEMY_TYPE_KILLER
		; SpecialPowerRadius = 100
	End

	Geometry = CYLINDER
	GeometryMajorRadius = 8.0
	GeometryMinorRadius = 8.0
	GeometryHeight = 19.2
	GeometryIsSmall = Yes
	Shadow = SHADOW_DECAL
	ShadowSizeX = 20;
	ShadowSizeY = 20;
	ShadowTexture = ShadowI;
End
