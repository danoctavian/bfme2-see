; ####################################################
; "Battle for Middle Earth II - Special Extended Edition - Director's Cut"
; ####################################################

; TrollDrum.INI for MORIA (Wild) faction...
; ------------------------------------------------------------------------------
; NOTE: Keep this organized!

Object TrollDrum

	SelectPortrait = BPCEttenmoorsDrum
 
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		OkToChangeModelColor  = Yes
		UseStandardModelNames = Yes
	
		DefaultModelConditionState
			Model = WBGobDrum
		End
		
		;-- building being placed
		ModelConditionState				= BUILD_PLACEMENT_CURSOR
			Shadow						= SHADOW_ALPHA_DECAL
			ShadowTexture				= Decal_Hero_Evil
			ShadowSizeX					= GOBLIN_DRUM_AOE_RADIUS_DECAL
			ShadowSizeY					= GOBLIN_DRUM_AOE_RADIUS_DECAL
		    ShadowOverrideLODVisibility = Yes
		End		

		ModelConditionState = SNOW ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			Model	= WBGobDrum_A		
			;Texture = GUHeroStat.tga GUHeroStat_Snow.tga
		ParticleSysBone   = CONSTDUSTBONE01 BuildingContructDust FollowBone:Yes			
		End  
		
		ModelConditionState     = ACTIVELY_BEING_CONSTRUCTED PARTIALLY_CONSTRUCTED
			Model               = WBGobDrum_A
			;ParticleSysBone	    = NONE BuildingDoughnutCloud
		ParticleSysBone   = CONSTDUSTBONE01 BuildingContructDust FollowBone:Yes			
		End  
		AnimationState          = ACTIVELY_BEING_CONSTRUCTED
			Animation
				AnimationName	= WBGobDrum_A.WBGobDrum_A
				AnimationMode   = MANUAL
			End
			BeginScript
				CurDrawablePlaySound("GondorBarracksBeginConstruction")
			EndScript
		End

		;--damaged building
	  
		ModelConditionState  = DAMAGED
			Model         = WBGobDrum
			ParticleSysBone = STEAM01 StructureFireSmoke_SEE Followbone:YES
		End
		AnimationState = DAMAGED
			EnteringStateFX	= FX_StatueDamaged		
		End	    
		
		ModelConditionState  = REALLYDAMAGED
			Model         = WBGobDrum
			ParticleSysBone = STEAM01 StructureFireSmoke_SEE Followbone:YES
		End
	    AnimationState = REALLYDAMAGED
		    EnteringStateFX	= FX_BuildingReallyDamaged
		End
 
		ModelConditionState  = COLLAPSING
			Model         = WBGobDrum_D
		End
		
		AnimationState = COLLAPSING
      		Animation				=	RubbleAnimation
				AnimationName		=	 WBGobDrum_D.WBGobDrum_D
				AnimationMode		=	ONCE
  			End
		End

		ModelConditionState  = RUBBLE
			Model         = WBGobDrum_D //None  
			ParticleSysBone SmokeLarge01 SmokeBuildingLarge
		End  
	    AnimationState = RUBBLE
	    	Animation				=	RubbleAnimation
				AnimationName		=	WBGobDrum_D.WBGobDrum_D //MBMMStatue1.MBMMStatue1 //dolglstatue_d3.dolglstatue_d3 //GPHealstue_D3.GPHealstue_D3
				AnimationMode		=	ONCE
  			End
		End		
		
		ModelConditionState  = POST_RUBBLE
			Model         = NONE
			ParticleSysBone NONE SmokeBuildingMediumRubble
		End
		
		AnimationState = POST_RUBBLE
		End

		ModelConditionState  = POST_COLLAPSE
		Model         = None
			ParticleSysBone NONE SmokeBuildingMediumRubble
		End
		
		AnimationState = POST_COLLAPSE
		End 


		ModelConditionState = SNOW
			Model	= WBGobDrum		
			;Texture = GUHeroStat.tga GUHeroStat_Snow.tga
		End 
	        	
  End

	Draw = W3DFloorDraw DrawFloorV1    
		StaticModelLODMode = Yes	
		ModelName = WBTrollDrum_Bib
		;WeatherTexture	= SNOWY WBTrollDrum_Bib.tga //No need for snow texture as it's quite bright already...
	End
	

	Draw = W3DScriptedModelDraw TheHealEffect
	    ModelConditionState  = NONE
			Model = None
			ParticleSysBone NONE StatueHeroFX
		End
	    ModelConditionState  = ACTIVELY_BEING_CONSTRUCTED
			Model = None
		End
	End 

   
    PlacementViewAngle	= 180 //0
   
  ; ***DESIGN parameters ***
  DisplayName			= OBJECT:WildDrum
  Description				= OBJECT:WildDrumDescription
  Side					= Wild
  IsTrainable				= No
  EditorSorting			= STRUCTURE
  ThreatLevel			= 1.0
  BuildCost           	= GOBLIN_DRUM_BUILDCOST  
  RefundValue			= GOBLIN_DRUM_REFUND_VALUE  
  BuildTime           	= STATUE_BUILDTIME  
  BountyValue         	= GOBLIN_DRUM_BOUNTY_VALUE  
  VisionRange         	= GOBLIN_DRUM_VISION_RANGE  
  ShroudClearingRange 	= GOBLIN_DRUM_SHROUD_CLEAR  
  CommandSet			= SellableCommandSet

	
	
	ArmorSet
		Conditions		= None
		Armor			= WoodArmor
		DamageFX		= GateDamageFX ;StructureDamageFXNoShake		
	End
	
	WeaponSet
		Conditions			= None
	End


; *** AUDIO Parameters ***

	VoiceSelect					= MoriaGoblinsDrummerArrives_SEE //WildCaveSelect
	SoundAmbient 				= AmbStatue_SEE	
	SoundOnDamaged				= BuildingLightDamageStone
	SoundOnReallyDamaged			= BuildingHeavyDamageStone
	VoiceSelectUnderConstruction	= BuildingEvilVoiceSelectUnderConstruction
	VoiceFullyCreated				= EVA:GenericBuildingComplete-Builder	

	UnitSpecificSounds
		UnderConstruction			= BuildingConstructionLoop  ; Built first time
		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound
		UnderRepairFromRubble		= BuildingConstructionLoop	; Repaired from completely destroyed (not used???)
	End
	
	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:StatueHeroicBuildStoneExplode	Animation:GPHealstue_A.GPHealstue_A		Frames:540
		AnimationSound = Sound:StatueHeroicBuildStoneDebris1	Animation:GPHealstue_A.GPHealstue_A		Frames:560
		AnimationSound = Sound:StatueHeroicBuildStoneDebris2	Animation:GPHealstue_A.GPHealstue_A		Frames:600
	End	

 
	; *** ENGINEERING Parameters ***

	RadarPriority			= STRUCTURE  
	KindOf				= NEED_BASE_FOUNDATION PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE MADE_OF_WOOD CAN_SEE_THROUGH_STRUCTURE IGNORE_FOR_VICTORY ;Last one added by Sûlherokh
	CommandPointBonus	= GENERIC_STATUE_COMMAND_POINT_BONUS	
	
	Body						= ActiveBody ModuleTag_05
		MaxHealth				= GOBLIN_DRUM_HEALTH
		MaxHealthDamaged		= GOBLIN_DRUM_HEALTH_DAMAGED
		MaxHealthReallyDamaged	= GOBLIN_DRUM_HEALTH_REALLY_DAMAGED
	End
	
	Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
		DestructionDelay  = 5000
	End	

	Behavior = PassiveAreaEffectBehavior ModuleTag_StatueBonus //ModuleTag_FeelGoodHero
		EffectRadius			= GOBLIN_DRUM_AOE_RADIUS //is 200!!! ; please update the decal size in experience lvl INI if you change this... the value there is about 2.2x the value here
		PingDelay			= 2000;msec
		ModifierName			= GenericDamageStackLeadership //GenericArmorStackLeadership    ;------------ Modified by Sûlherokhh (was HeroicStatuePassiveLeadership)
		; AntiCategories		= BUFF (Why is the out? It's in for Gondor?) Testing...
		AllowFilter			= GENERIC_BUFF_RECIPIENT_OBJECT_FILTER
	End	
	
	Behavior            = GettingBuiltBehavior GetBuiltBehaviorTag
		WorkerName		= WildLaborerNoSelect
		SpawnTimer	= DEFAULT_STRUCTURE_HEALDELAY
		RebuildWhenDead = Yes
        SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
	End
	
	Behavior = KeepObjectDie ModuleTag_IWantRubble
	End

	Behavior                  = StructureCollapseUpdate ModuleTag_StructureCollapseUpdate 
		MinCollapseDelay        = 000
		MaxCollapseDelay        = 000
		CollapseDamping         = .5
		MaxShudder              = 0.6
		MinBurstDelay           = 250
		MaxBurstDelay           = 800
		BigBurstFrequency       = 4
		FXList                  = INITIAL   FX_StructureMediumCollapse
		FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse
		DestroyObjectWhenDone	= Yes
		CollapseHeight			= 126 //0
	End
	
	Behavior = TerrainResourceBehavior ModuleTag_NewMoneyDeadSpot
		Radius = 50		; How far we try to claim ground
		MaxIncome = 0	; If we were to get all we wanted, how much we would earn.  Linear slope to 0 at 0% claim
		IncomeInterval = 999999	; How often (in msec) we give that much money
		HighPriority = Yes ; A high priority claim gets to pretend it was there first.
		Visible = No 		;// Don't show decal when a resource building is selected.
	End
	
;	Behavior = RefundDie ModuleTag_refund
;		UpgradeRequired = Upgrade_MarketplaceUpgradeDefiance
;		BuildingRequired = ANY +GondorMarketPlace
;		RefundPercent = 50%
;	End	

	Behavior = PassiveAreaEffectBehavior ModuleTag_StatueHealing //ModuleTag_SplashOfHealingWater_Ahh
		EffectRadius			= GOBLIN_DRUM_AOE_RADIUS //is 200!!! ; please update the decal size in experience lvl INI if you change this... the value there is about 2.2x the value here		
		PingDelay			= 2000;msec
		HealPercentPerSecond	= 2% ;3%
		AllowFilter			= ANY +INFANTRY +CAVALRY -MACHINE +MONSTER -IMMOBILE    
		NonStackable			= Yes
		HealFX				= FX_SpellHealUnitHealBuff
	End	

	Behavior = CostModifierUpgrade ModuleTag_CostModifier
	LabelForPalantirString = GUI:INFANTRYDiscount //HERO_DISCOUNT
		StartsActive = Yes ; Run on build complete, not upgrade
		ObjectFilter		= ANY +INFANTRY -HERO
		Percentage			=  -5% //-4%		;; 1 GondorStatue
		Percentage			=  -10% //-8%		;; 2 GondorStatues
		Percentage			= -15% //-12%		;; 3 GondorStatues
		Percentage			= -20% //-16%		;; 4 GondorStatues
		Percentage			= -25% //-20%		;; 5 GondorStatues
		Percentage			= -30% //-24%		;; 6 GondorStatues
		Percentage			= -35% //-28%		;; 7 GondorStatues
		Percentage			= -40% //-32%		;; 8 GondorStatues
		Percentage			= -45% //-36%		;; 9 GondorStatues
		Percentage			= -50% //-40%		;; 10 GondorStatues
  End


;  Behavior = FlammableUpdate ModuleTag_14
;    AflameDuration = 5000         ; If I catch fire, I'll burn for this long...
;    AflameDamageAmount = 5       ; taking this much damage...
;    AflameDamageDelay = 500       ; this often.
;  End
 
;  Behavior = TransitionDamageFX ModuleTag_15
;    ;-------------DESIGNED FOR SMALL SIZED FACTION BUILDING TRANSITIONS-------------------
;    DamagedParticleSystem1       = Bone:None RandomBone:No PSys:StructureTransitionSmallSmoke
;    ;---------------------------------------------------------------------------------------
;    ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionSmallSmoke
;    ReallyDamagedParticleSystem2 = Bone:None RandomBone:No PSys:StructureTransitionSmallExplosion
;    ReallyDamagedParticleSystem3 = Bone:None RandomBone:No PSys:StructureTransitionSmallShockwave
;  End
 
;  Behavior             = FXListDie ModuleTag_16
;    DeathFX       = FX_BuildingDie
;  End
	
	Geometry			= CYLINDER
	GeometryMajorRadius	= 40.0
	GeometryHeight		= 25.0
	GeometryOffset		= X:4 Y:0 Z:0
	GeometryIsSmall		= No
	
	Shadow				= SHADOW_VOLUME
	BuildCompletion		= PLACED_BY_PLAYER
	
	AttackContactPoint 	= X:-24 Y:-24 Z:92

	GeometryContactPoint	= X:-40.188		Y:41.694	Z:0			Repair
	GeometryContactPoint	= X:35.037		Y:-26.085	Z:0			Repair
	GeometryContactPoint	= X:40.629		Y:32.691	Z:0
	GeometryContactPoint	= X:-56.679		Y:-3.451	Z:0
	GeometryContactPoint	= X:27.139		Y:11.062	Z:32.902	Swoop

End
