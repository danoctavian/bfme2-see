///The Trolling Spider rider...
;----------------------------------------------------------------------------------------------------------------------
;
;	GoblinSpiderRider
;
;----------------------------------------------------------------------------------------------------------------------
Object GoblinSpiderRiderBanner
	; ***ART Parameters ***

	SelectPortrait         = UPWild_SpiderRider

	Draw = W3DHordeModelDraw ModuleTag_01

	  OkToChangeModelColor = Yes
	  
    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD
    LodOptions							= LOW
		AllowMultipleModels				= ALLOW_MULTIPLE_MODELS_LOW
		MaxRandomTextures				= MAX_RANDOM_TEXTURES_LOW
		MaxRandomAnimations				= MAX_RANDOM_ANIMATIONS_LOW
		MaxAnimFrameDelta				= MAX_ANIM_FRAME_DELTA_LOW
	End
	
	LodOptions							= MEDIUM
		AllowMultipleModels				= ALLOW_MULTIPLE_MODELS_MED
		MaxRandomTextures				= MAX_RANDOM_TEXTURES_MED
		MaxRandomAnimations				= MAX_RANDOM_ANIMATIONS_MED
		MaxAnimFrameDelta				= MAX_ANIM_FRAME_DELTA_MED
	End
	
	LodOptions							= HIGH
		AllowMultipleModels				= ALLOW_MULTIPLE_MODELS_HIGH
		MaxRandomTextures				= MAX_RANDOM_TEXTURES_HIGH
		MaxRandomAnimations				= MAX_RANDOM_ANIMATIONS_HIGH
		MaxAnimFrameDelta				= MAX_ANIM_FRAME_DELTA_HIGH
	End
    
;;====================== MODELS ================================================================
		DefaultModelConditionState
			Model						= MUSpdBnr_SKN
			Skeleton					= MUSpidRdr_SKL
			WeaponLaunchBone			= PRIMARY ARROW
			WeaponLaunchBone			= SECONDARY ARROWNOCK	; when upgraded to flaming arrow
 			  
		End

; --------- With Sword ------------
		ModelConditionState				= WEAPONSET_TOGGLE_1
			Model						= MUSpdBnr_SKN
			Skeleton					= MUSpidRdr_SKL
			ParticleSysBone Sword01 SpiderRiderPoison FollowBone:Yes    ;  to be added to poison spear upgrade
			ParticleSysBone Sword01 SpiderRiderPoison2 FollowBone:Yes   ;  to be added to poison spear upgrade
		End

; --------- With Fire arrows Upgrade  ------------
		ModelConditionState				= WEAPONSET_PLAYER_UPGRADE USER_4
			Model						= MUSpdBnr_SKN
			Skeleton					= MUSpidRdr_SKL
			WeaponLaunchBone			= PRIMARY ARROW
			WeaponLaunchBone			= SECONDARY ARROWNOCK	; when upgraded to flaming arrow
		;	ParticleSysBone				= FireArowTip arrowFire FollowBone:Yes
		;	ParticleSysBone				= FireArowTip arrowFire FollowBone:Yes
		End

;;================== ANIMATIONS =================================================================

		
		;//--------------WallScaling---------------

		AnimationState						= CLIMBING
			StateName						= STATE_Climbing
			Animation						= Climbing
				AnimationName				= MUSpidRdr_WALB
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
			BeginScript;script to set transition from moving
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Running"  then CurDrawableSetTransitionAnimState("Trans_RunningToClimbing") return end
				;if Prev == "STATE_Rappelling"  then CurDrawableSetTransitionAnimState("Trans_RappellingToClimbing") return end
			EndScript
		End
		TransitionState = Trans_RunningToClimbing
			Animation = Transition
				AnimationName = MUSpidRdr_WALC
				AnimationMode = ONCE
			End
		End
		;TransitionState = Trans_RappellingToClimbing
		;	Animation = Transition
		;		AnimationName = MUSpidRdr_UNKNOWN
		;		AnimationMode = ONCE_BACKWARDS
		;	End
		;End
		AnimationState						= RAPPELLING
			StateName						= STATE_Rappelling
			Animation						= Rapelling
				AnimationName				= MUSpidRdr_WALD
				AnimationMode				= LOOP
				AnimationBlendTime			= 10
			End
			BeginScript;script to set transition from moving
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Running"  then CurDrawableSetTransitionAnimState("Trans_RunningToRappelling") return end
				;if Prev == "STATE_Climbing"  then CurDrawableSetTransitionAnimState("Trans_ClimbingToRappelling") return end
			EndScript
		End
		TransitionState = Trans_RunningToRappelling
			Animation = Transition
				AnimationName = MUSpidRdr_WALG
				AnimationMode = ONCE
			End
		End
		;TransitionState = Trans_ClimbingToRappelling
		;	Animation = Transition
		;		AnimationName = MUSpidRdr_UNKNOWN
		;		AnimationMode = ONCE
		;	End
		;End		
		TransitionState = Trans_ClimbingToRunning
			Animation = Transition
				AnimationName = MUSpidRdr_WALF
				AnimationMode = ONCE
			End
		End
		TransitionState = Trans_RappellingToRunning
			Animation = Transition
				AnimationName = MUSpidRdr_WALE
				AnimationMode = ONCE
			End
		End
			
			
		; ------ Flying ------- ;
			
		AnimationState					= PASSENGER WEAPONSET_TOGGLE_1
			StateName					= STATE_Grabbed
			Animation					= Sword
				AnimationName			= MUSpidRdr_FLYA
				AnimationMode			= LOOP
			End
		End
		
		AnimationState					= PASSENGER
			StateName					= STATE_Grabbed
			Animation					= Bow
				AnimationName			= MUSpidRdr_FLYB
				AnimationMode			= LOOP
			End
		End
		
		AnimationState					= FREEFALL WEAPONSET_TOGGLE_1
			StateName					= STATE_Falling
			Animation					= Sword
				AnimationName			= MUSpidRdr_FLYA
				AnimationMode			= LOOP
				AnimationBlendTime		= 10
;				AnimationSpeedFactorRange	= 0.24	0.24
			End
		End
		
		AnimationState					= FREEFALL
			StateName					= STATE_Falling
			Animation					= Bow
				AnimationName			= MUSpidRdr_FLYB
				AnimationMode			= LOOP
				AnimationBlendTime		= 10
;				AnimationSpeedFactorRange	= 0.5	0.5
			End
		End
		
		AnimationState        			= STUNNED_FLAILING WEAPONSET_TOGGLE_1
			StateName					= STATE_Fly
			Animation           		= Sword
				AnimationName       	= MUSpidRdr_FLYA
				AnimationMode       	= LOOP
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES2
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "Ready_Bow" or PrevState == "Moving_Bow" or PrevState == "Bored_Bow"								;;;;;;#TODO put in various bow states here
				then
					CurDrawableShowSubObject("arrow")
					CurDrawableShowSubObject("arrownock")
					return "WantSword"
				elseif PrevState == "STATE_Fly"
				then
					if PrevAnim == "Bow" or PrevAnim == "WantSword"
					then
						CurDrawableShowSubObject("arrow")
						CurDrawableShowSubObject("arrownock")
						return "WantSword"
					end
				end
					
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				return "Sword"
			EndScript
		End

		AnimationState        			= STUNNED_FLAILING
			StateName					= STATE_Fly
			Animation
				AnimationName       	= MUSpidRdr_FLYB
				AnimationMode       	= LOOP
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES2
		End
		
		AnimationState					= DYING  SPLATTED WEAPONSET_TOGGLE_1 ;DEATH_1
			StateName					= STATE_Dead
			Animation					= Sword
				AnimationName			= MUSpidRdr_LNDA
				AnimationMode			= ONCE
			End
		End
		
		AnimationState					= DYING DEATH_1 SPLATTED
			StateName					= STATE_Dead
			Animation					= Bow
				AnimationName			= MUSpidRdr_LNDB
				AnimationMode			= ONCE
			End
		End
		
				; ------ Dying ------- ;

		AnimationState        			= DYING  WEAPONSET_TOGGLE_1 ;DEATH_1
			Animation           		= Sword1
				AnimationName       	= MUSpidRdr_DIEA
				AnimationMode       	= ONCE
			End
			Animation           		= WantSword
				AnimationName       	= MUSpidRdr_DIEB
				AnimationMode       	= ONCE
			End
			
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "STATE_Fly"
				then
					CurDrawableShowSubObject("arrow")
					CurDrawableShowSubObject("arrownock")
					return "WantSword"
				end
			
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				if GetClientRandomNumberReal(0,2) < 1
				then
					return "Sword1"
				else
					return "Sword2"
				end
			EndScript
		End
		
;		AnimationState        			= DYING DEATH_2 WEAPONSET_TOGGLE_1
;			Animation           		= FadeOut
;				AnimationName       	= RUElfWar_IDLG
;				AnimationMode       	= LOOP
;			End
;		End
		
		AnimationState        			= DYING ;DEATH_1
			Animation           		= Bow1
				AnimationName       	= MUSpidRdr_DIEB
				AnimationMode       	= ONCE
			End
			Animation           		= Bow2
				AnimationName       	= MUSpidRdr_DIEB
				AnimationMode       	= ONCE
			End
			Animation           		= WantBow
				AnimationName       	= MUSpidRdr_LNDB
				AnimationMode       	= ONCE
			End
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				
				if PrevState == "STATE_Fly"
				then
					CurDrawableHideSubObject("ArrowNock")
					CurDrawableHideSubObject("arrow")
					return "WantBow"
				end
				
				if GetClientRandomNumberReal(0,2) < 1
				then
					CurDrawableShowSubObject("arrow")
					CurDrawableShowSubObject("arrownock")
					return "Bow1"
				else
					CurDrawableShowSubObject("arrow")
					CurDrawableShowSubObject("arrownock")
					return "Bow2"
				end
			EndScript
		End
		
;		AnimationState        			= DYING DEATH_2
;			Animation					= FadeOut
;				AnimationName			= RUElfWar_IDLDX1
;				AnimationMode			= ONCE
;			End
;		End
		

		AnimationState        			= STUNNED_STANDING_UP WEAPONSET_TOGGLE_1
			StateName					= STATE_GetUp
			Animation           		= Sword
				AnimationName       	= MUSpidRdr_GTPA
				AnimationMode       	= ONCE
			End
			Animation           		= WantSword
				AnimationName       	= MUSpidRdr_GTPB
				AnimationMode       	= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES4
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
				then
					if PrevAnim == "Bow" or PrevAnim == "WantSword"
					then	
						CurDrawableShowSubObject("arrow")
						CurDrawableShowSubObject("arrownock")
						return "WantSword"
					end
				end
				
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				return "Sword"
			EndScript
		End
		
		
		
		AnimationState        			= STUNNED_STANDING_UP
			StateName					= STATE_GetUp
			Animation           		= Bow
				AnimationName       	= MUSpidRdr_GTPB
				AnimationMode       	= ONCE
			End
			Animation           		= WantBow
				AnimationName       	= MUSpidRdr_GTPA
				AnimationMode       	= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES4
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "STATE_GetUp" or PrevState == "STATE_Land"
				then
					if PrevAnim == "WantBow" or PrevAnim == "Sword"
					then
						CurDrawableHideSubObject("ArrowNock")
						CurDrawableHideSubObject("arrow")
						return "WantBow"
					end
				else
					CurDrawableShowSubObject("arrow")
					CurDrawableShowSubObject("arrownock")
					return "Bow"
				end
			EndScript
		End

		AnimationState        			= STUNNED WEAPONSET_TOGGLE_1
			StateName					= STATE_Land
			Animation           		= Sword
				AnimationName       	= MUSpidRdr_LNDA
				AnimationMode       	= ONCE
			End
			Animation           		= WantSword
				AnimationName       	= MUSpidRdr_LNDB
				AnimationMode       	= ONCE
			End
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "STATE_Fly"
				then
					if PrevAnim == "WantSword" or PrevAnim == "Bow"
					then
						CurDrawableShowSubObject("arrow")
						CurDrawableShowSubObject("arrownock")
						return "WantSword"
					end
				end
				Flags						= MAINTAIN_FRAME_ACROSS_STATES3
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				return "Sword"
			EndScript
		End
		
		AnimationState        			= STUNNED
			StateName					= STATE_Land
			Animation           		= Bow
				AnimationName       	= MUSpidRdr_LNDA
				AnimationMode       	= ONCE
			End
			Animation           		= WantBow
				AnimationName       	= MUSpidRdr_LNDB
				AnimationMode       	= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES3
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				PrevAnim = CurDrawablePrevAnimation()
				if PrevState == "STATE_Fly"
				then
					if PrevAnim == "WantBow" or PrevAnim == "Sword"
					then
						CurDrawableHideSubObject("ArrowNock")
						CurDrawableHideSubObject("arrow")
						return "WantBow"
					end
				end
				
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				return "Bow"
			EndScript
		End


				
;;======== TERROR

;		AnimationState					= MOVING EMOTION_TERROR WEAPONSET_TOGGLE_1
;			StateName					= Moving_Sword
;			Animation					= Terror
;				AnimationName			= RUElfWar_RUNN
;				AnimationMode			= LOOP
;				Distance				= 40
;			End
;			Animation					= finishrun_b
;				AnimationName       	= RUElfWar_RUNB
;				AnimationMode       	= ONCE
;				AnimationBlendTime		= 0
;				Distance				= 40
;			End
;			Animation					= runtrans_bs
;				AnimationName       	= RUElfWar_RUNC
;				AnimationMode       	= ONCE
;				AnimationBlendTime		= 5
;				Distance				= 70
;			End
;			Animation					= runtrans_sb_finish
;				AnimationName       	= RUElfWar_RUNT
;				AnimationMode       	= ONCE
;				AnimationBlendTime		= 0
;				Distance				= 70
;			End
;			Animation					= runnoblend_s
;				AnimationName       	= RUElfWar_RUNN
;				AnimationMode       	= LOOP
;				AnimationBlendTime		= 0
;				Distance				= 40
;			End
;			Flags						= RESTART_ANIM_WHEN_COMPLETE MAINTAIN_FRAME_ACROSS_STATES
;			BeginScript
;				PrevAnim	= CurDrawablePrevAnimation()
;				PrevState	= CurDrawablePrevAnimationState()
;				CurDrawableHideSubObject("ARROW")
;				CurDrawableHideSubObject("ARROWNOCK")
;				
;				if PrevState == "Moving_Bow"
;				then
;					if PrevAnim == "runtrans_sb"
;					then
;						return "runtrans_sb_finish"
;					elseif PrevAnim == "finishrun_s"
;					then
;						return "runnoblend_s"
;					else
;						return "finishrun_b"
;					end
;				elseif PrevAnim == "finishrun_b" or PrevAnim == "runtrans_sb_finish"
;				then
;					return "runtrans_bs"
;				elseif PrevAnim == "runtrans_bs" or PrevAnim == "run_s" or PrevAnim == "runnoblend_s"
;				then
;					return "runnoblend_s"
;				else
;					return "Terror"
;				end				
;			EndScript
;		End
;		AnimationState					= MOVING EMOTION_TERROR
;			StateName					= Moving_Bow
;			Animation					= RunAway_3
;				AnimationName			= RUElfWar_RUNOT3
;				AnimationMode			= ONCE
;				Distance				= 40
;			End
;			Animation					= RunAway_2
;				AnimationName			= RUElfWar_RUNOT4
;				AnimationMode			= ONCE
;				Distance				= 40
;			End
;			Animation					= RunAway
;				AnimationName			= RUElfWar_RUNB
;				AnimationMode			= ONCE
;				Distance				= 40
;			End
;			Animation					= finishrun_s
;				AnimationName       	= RUElfWar_RUNN
;				AnimationMode       	= ONCE
;				AnimationBlendTime		= 0
;				Distance				= 40
;			End
;			Animation					= runtrans_sb
;				AnimationName       	= RUElfWar_RUNT
;				AnimationMode       	= ONCE
;				AnimationBlendTime		= 5
;				Distance				= 70
;			End
;			Animation					= runtrans_bs_finish
;				AnimationName       	= RUElfWar_RUNC
;				AnimationMode       	= ONCE
;				AnimationBlendTime		= 0
;				Distance				= 70
;			End
;			Animation					= RunAway_noblend
;				AnimationName			= RUElfWar_RUNB
;				AnimationMode			= ONCE
;				AnimationBlendTime		= 0
;				Distance				= 40
;			End
;			Flags						= RESTART_ANIM_WHEN_COMPLETE MAINTAIN_FRAME_ACROSS_STATES
;			BeginScript
;				PrevAnim	= CurDrawablePrevAnimation()
;				PrevState	= CurDrawablePrevAnimationState()
;				CurDrawableShowSubObject("arrow")
;				CurDrawableShowSubObject("arrownock")
;				
;				if PrevState == "Moving_Sword"
;				then
;					if PrevAnim == "runtrans_bs"
;					then
;						return "runtrans_bs_finish"
;					elseif PrevAnim == "finishrun_b"
;					then
;						return "RunAway_noblend"
;					else
;						return "finishrun_s"
;					end
;				elseif PrevAnim == "finishrun_s" or PrevAnim == "runtrans_bs_finish"
;				then
;					return "runtrans_sb"
;				elseif PrevAnim == "runtrans_sb" or PrevAnim == "run_b" or PrevAnim == "runnoblend_b"
;				then
;					return "RunAway_noblend"
;				else
;					Num = GetClientRandomNumberReal(0,7)
;					if Num < 1 
;					then
;						return "RunAway_2"
;					elseif Num > 6
;					then
;						return "RunAway_3"
;					else
;						return "RunAway"
;					end
;				end			
;			EndScript
;		End


		
		


		AnimationState        			= ATTACKING TURN_LEFT WEAPONSET_TOGGLE_1 
			StateName					= Moving_Sword
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TRNLH
				AnimationMode       	= LOOP
			End
		End

		AnimationState        			= ATTACKING TURN_LEFT  
			StateName					= Moving_Bow
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TNLBH
				AnimationMode       	= LOOP
			End
		End

		AnimationState        			= ATTACKING TURN_RIGHT WEAPONSET_TOGGLE_1 
			StateName					= Moving_Sword
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TRNRH
				AnimationMode       	= LOOP
			End
		End

		AnimationState        			= ATTACKING TURN_RIGHT  
			StateName					= Moving_Bow
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TNRBH
				AnimationMode       	= LOOP
			End
		End
		
		

		; ------ Attacking ------- ;
		
		AnimationState        			= FIRING_OR_PREATTACK_A WEAPONSET_TOGGLE_1
			StateName					= Ready_Sword
			
			Animation           		= AttackWithSwordA
				AnimationName       	= MUSpidRdr_ATKA
				AnimationMode       	= ONCE
				UseWeaponTiming			= Yes
			End
			Animation           		= AttackWithSwordB
				AnimationName       	= MUSpidRdr_ATKA
				AnimationMode       	= ONCE
				UseWeaponTiming			= Yes
			End
			Animation           		= AttackWithSwordD
				AnimationName       	= MUSpidRdr_ATKA
				AnimationMode       	= ONCE
				UseWeaponTiming			= Yes
			End
			BeginScript
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
			EndScript
		End
;;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

		AnimationState					= PREATTACK_A 
			Animation					= ReadyToDrawn
				AnimationName			= MUSpidRdr_ATKB
				AnimationMode			= ONCE
				AnimationBlendTime		= 20				; Must be 0 blend time otherwise the arrow will linger for the duration of the blend!
			End
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("ArrowNock")
			EndScript
		End

;		AnimationState					= FIRING_OR_RELOADING_A
;			StateName					= STATE_Firing
;			Animation					= OneFrameOfShooting
;				AnimationName			= MUSpidRdr_ATKB
;				AnimationMode			= ONCE
;				AnimationBlendTime		= 0
;				AnimationSpeedFactorRange	= 1.5 1.5
;			End
;			Flags						= START_FRAME_FIRST			
;			BeginScript
;				CurDrawableShowSubObject("arrow")
;				CurDrawableShowSubObject("ArrowNock")
;			EndScript
;		End
;;<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<


;;------------------------- BACKUP --------------------------------------------------------------------


		AnimationState					= MOVING BACKING_UP WEAPONSET_TOGGLE_1
			StateName					= STATE_BackingUp
			Animation					= Sword
				AnimationName			= MUSpidRdr_BAKA
				AnimationMode			= LOOP
			End
			Animation					= WantSword
				AnimationName			= MUSpidRdr_BAKB
				AnimationMode			= LOOP
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES4
			BeginScript
				CurDrawableHideSubObject("ARROW")
				CurDrawableHideSubObject("ARROWNOCK")
				PrevAnim	= CurDrawablePrevAnimation()
				PrevState	= CurDrawablePrevAnimationState()
				if PrevState == "STATE_BackingUp"
				then
					if PrevAnim == "Bow" or PrevAnim == "WantSword"
					then
						return "WantSword"
					end
				end
				
				return "Sword"			
			EndScript
		End
		AnimationState					= MOVING BACKING_UP
			StateName					= STATE_BackingUp
			Animation					= Bow
				AnimationName			= MUSpidRdr_BAKB
				AnimationMode			= LOOP
			End
			Animation					= WantBow
				AnimationName			= MUSpidRdr_BAKA
				AnimationMode			= LOOP
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES4
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				PrevAnim	= CurDrawablePrevAnimation()
				PrevState	= CurDrawablePrevAnimationState()
				if PrevState == "STATE_BackingUp"
				then
					if PrevAnim == "WantBow" or PrevAnim == "Sword"
					then
						return "WantBow"
					end
				end
				
				return "Bow"
			EndScript
		End
		
		; -------- Turning -----------------;
		
		AnimationState        			= TURN_LEFT_HIGH_SPEED WEAPONSET_TOGGLE_1 
			StateName					= Moving_Sword
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TRNLH
				AnimationMode       	= LOOP
			End
		End

		AnimationState        			= TURN_LEFT_HIGH_SPEED  
			StateName					= Moving_Bow
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TNLBH
				AnimationMode       	= LOOP
			End
		End

		AnimationState        			= TURN_RIGHT_HIGH_SPEED WEAPONSET_TOGGLE_1 
			StateName					= Moving_Sword
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TRNRH
				AnimationMode       	= LOOP
			End
		End

		AnimationState        			= TURN_RIGHT_HIGH_SPEED  
			StateName					= Moving_Bow
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TNRBH
				AnimationMode       	= LOOP
			End
		End



		AnimationState        			= TURN_LEFT WEAPONSET_TOGGLE_1 
			StateName					= Moving_Sword
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TRNLH
				AnimationMode       	= LOOP
			End
		End

		AnimationState        			= TURN_LEFT  
			StateName					= Moving_Bow
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TNLBH
				AnimationMode       	= LOOP
			End
		End

		AnimationState        			= TURN_RIGHT WEAPONSET_TOGGLE_1 
			StateName					= Moving_Sword
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TRNRH
				AnimationMode       	= LOOP
			End
		End

		AnimationState        			= TURN_RIGHT  
			StateName					= Moving_Bow
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_TNRBH
				AnimationMode       	= LOOP
			End
		End


									
		; ------------ Moving ------------- ;
		
		AnimationState        			= MOVING WEAPONSET_TOGGLE_1
			StateName					= Moving_Sword
			SimilarRestart				= Yes
			Animation           		= run_s
				AnimationName       	= MUSpidRdr_RUNC
				AnimationMode       	= LOOP
			End
			Animation					= finishrun_b
				AnimationName       	= MUSpidRdr_RUND
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
			End
			Animation					= runtrans_bs
				AnimationName       	= MUSpidRdr_RUND
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
			End
			Animation					= runtrans_sb_finish
				AnimationName       	= MUSpidRdr_RUND
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
			End
			Animation					= runnoblend_s
				AnimationName       	= MUSpidRdr_RUNC
				AnimationMode       	= LOOP
				AnimationBlendTime		= 0
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevAnim	= CurDrawablePrevAnimation()
				PrevState	= CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("ARROW")
				CurDrawableHideSubObject("ARROWNOCK")
				
				if PrevState == "Moving_Bow"
				then
					if PrevAnim == "runtrans_sb"
					then
						return "runtrans_sb_finish"
					elseif PrevAnim == "finishrun_s"
					then
						return "runnoblend_s"
					else
						return "finishrun_b"
					end
				elseif PrevAnim == "finishrun_b" or PrevAnim == "runtrans_sb_finish" or PrevAnim == "WantSword"
				then
					return "runtrans_bs"
				elseif PrevAnim == "runtrans_bs" or PrevAnim == "run_s" or PrevAnim == "runnoblend_s"
				then
					return "runnoblend_s"
				else
					return "run_s"
				end				
			EndScript
		End
		
		AnimationState        			= MOVING
			StateName					= Moving_Bow
			SimilarRestart				= Yes
			Animation           		= run_b
				AnimationName       	= MUSpidRdr_RUND
				AnimationMode       	= LOOP
;				Distance				= 40
			End
			Animation					= finishrun_s
				AnimationName       	= MUSpidRdr_RUNC
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
;				Distance				= 40
			End
			Animation					= runtrans_sb
				AnimationName       	= MUSpidRdr_RUNC
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
;				Distance				= 70
			End
			Animation					= runtrans_bs_finish
				AnimationName       	= MUSpidRdr_RUNC
				AnimationMode       	= ONCE
				AnimationBlendTime		= 0
;				Distance				= 70
			End
			Animation					= runnoblend_b
				AnimationName       	= MUSpidRdr_RUND
				AnimationMode       	= LOOP
				AnimationBlendTime		= 0
;				Distance				= 40
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				PrevAnim	= CurDrawablePrevAnimation()
				PrevState	= CurDrawablePrevAnimationState()
				
				
				
				Prev = CurDrawablePrevAnimationState()
				if PrevState == "STATE_Climbing"
				then
					CurDrawableSetTransitionAnimState("Trans_ClimbingToRunning")
					return
				elseif PrevState == "STATE_Rappelling"
				then
					CurDrawableSetTransitionAnimState("Trans_RappellingToRunning")
					return
				elseif PrevState == "Moving_Sword"
				then
					if PrevAnim == "runtrans_bs"
					then
						return "runtrans_bs_finish"
					elseif PrevAnim == "finishrun_b"
					then
						return "runnoblend_b"
					else
						return "finishrun_s"
					end
				elseif PrevAnim == "finishrun_s" or PrevAnim == "runtrans_bs_finish" or PrevAnim == "WantBow"
				then
					return "runtrans_sb"
				elseif PrevAnim == "runtrans_sb" or PrevAnim == "run_b" or PrevAnim == "runnoblend_b"
				then
					return "runnoblend_b"
				else
					return "run_b"
				end
			EndScript
		End
		
		
;;-----------------------------------------------------------------------------------<<<<<<<<<<<<<<<<<<<<<<<<<<<

		AnimationState					= CONTINUOUS_FIRE_MEAN		;;;;;;;;;HACK TO STOP JITTERS
			Animation					= HangFrameWhileCoasting
				AnimationName			= MUSpidRdr_ATKB
				AnimationMode			= LOOP ;MANUAL
				AnimationBlendTime		= 0
			End
			Flags						= START_FRAME_LAST
						
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("ARROWNOCK")
				if CurDrawablePrevAnimationState() == "STATE_Firing" then CurDrawableAllowToContinue() end
			EndScript
			;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
			;;;;
			;;;;	VERY IMPORTANT ARCHER INFORMATION
			;;;;	THIS WILL STOP THE JITTERS, AND BEST
			;;;;	YET, IT'S A COMPLETE HACK! Just look above.
			;;;;	We say that if we get into this state
			;;;;	from firing, just continue to fire. DONE.
			;;;;
			;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
		End
		
		AnimationState					= CONTINUOUS_FIRE_SLOW
			StateName					= Ready_Bow
			Animation					= PutAwayArrow
				AnimationName			= MUSpidRdr_ATKB
				AnimationMode			= ONCE
			End
						
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("ARROWNOCK")
			EndScript
		End
;;;--------------------------------------------------------------------------------------<<<<<<<<<<<<<<<<<<<<<<<		
	
		AnimationState					= EMOTION_UNCONTROLLABLY_AFRAID WEAPONSET_TOGGLE_1
			StateName					= STATE_Emotion_Sword
			Animation					= Sword
				AnimationName			= MUSpidRdr_FERA
				AnimationMode			= ONCE
			End
			Animation					= Sword2
				AnimationName			= MUSpidRdr_FERB
				AnimationMode			= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
					end
				end
			EndScript
		End
		AnimationState					= EMOTION_UNCONTROLLABLY_AFRAID 
			StateName					= STATE_Emotion_Bow
			Animation					= Bow
				AnimationName			= MUSpidRdr_FERB
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End	
			Animation					= Bow2
				AnimationName			= MUSpidRdr_FERB
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
					end
				end
			EndScript	
		End
		
	
		; -------- Alert ------- ;
		
		AnimationState					= EMOTION_ALERT WEAPONSET_TOGGLE_1
			StateName					= Ready_Sword
			
			Animation					= Alert_1
				AnimationName			= MUSpidRdr_TGLB
				AnimationMode			= LOOP
			End
			
			BeginScript
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				if Prev == "Bored_Sword"		then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")			end
				if Prev == "Selected_Sword"		then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")			end
				if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
				then 
					CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")	
				end
			EndScript
		End
		AnimationState					= ENGAGED WEAPONSET_TOGGLE_1
			StateName					= Ready_Sword
			
			Animation					= Alert_1
				AnimationName			= MUSpidRdr_TGLB
				AnimationMode			= LOOP
			End
			
			BeginScript
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				if Prev == "Bored_Sword"		then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")			end
				if Prev == "Selected_Sword"		then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")			end
				if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
				then 
					CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")	
				end
			EndScript
		End
		AnimationState					= ATTACKING WEAPONSET_TOGGLE_1
			StateName					= Ready_Sword
			
			Animation					= Alert_1
				AnimationName			= MUSpidRdr_TGLB
				AnimationMode			= LOOP
			End
			
			BeginScript
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("ArrowNock")
				CurDrawableHideSubObject("arrow")
				if Prev == "Bored_Sword"		then CurDrawableSetTransitionAnimState("TRANS_BR_Sword")			end
				if Prev == "Selected_Sword"		then CurDrawableSetTransitionAnimState("TRANS_SR_Sword")			end
				if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
				then 
					CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")	
				end
			EndScript
		End
		
;		AnimationState					= EMOTION_ALERT
;			StateName					= Ready_Bow
;			
;			Animation					= IDLB
;				AnimationName			= RUElfWar_IDLB
;				AnimationMode			= LOOP
;			End
;			
;			BeginScript
;				CurDrawableShowSubObject("arrow")
;				CurDrawableShowSubObject("arrownock")
;				PrevAnim = CurDrawablePrevAnimation()
;				Prev = CurDrawablePrevAnimationState()
;				if Prev == "Bored_Bow"		then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")				end
;				if Prev == "Selected_Bow"	then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")				end
;				if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
;				then 
;					CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")	
;				end				
;			EndScript
;		End 
;		AnimationState					= ENGAGED
;			StateName					= Ready_Bow
;			
;			Animation					= IDLB
;				AnimationName			= RUElfWar_IDLB
;				AnimationMode			= LOOP
;			End
;			
;			BeginScript
;				CurDrawableShowSubObject("arrow")
;				CurDrawableShowSubObject("arrownock")
;				PrevAnim = CurDrawablePrevAnimation()
;				Prev = CurDrawablePrevAnimationState()
;				if Prev == "Bored_Bow"		then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")				end
;				if Prev == "Selected_Bow"	then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")				end
;				if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
;				then 
;					CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")	
;				end				
;			EndScript
;		End
		AnimationState					= ATTACKING
			StateName					= Ready_Bow
			
			Animation					= IDLB
				AnimationName			= MUSpidRdr_ATKB
				AnimationMode			= LOOP
			End
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Bored_Bow"		then CurDrawableSetTransitionAnimState("TRANS_BR_Bow")				end
				if Prev == "Selected_Bow"	then CurDrawableSetTransitionAnimState("TRANS_SR_Bow")				end
				if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
				then 
					CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")	
				end				
			EndScript
		End
		
		
		
;;------------ EMOTIONS ------------------------------------------------------------------
;;======= AFRAID

		AnimationState					= EMOTION_AFRAID WEAPONSET_TOGGLE_1
			StateName					= STATE_Emotion_Sword
			Animation					= Sword
				AnimationName			= MUSpidRdr_FERA
				AnimationMode			= ONCE
			End
			Animation					= Sword2
				AnimationName			= MUSpidRdr_FERA
				AnimationMode			= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
					end
				end
			EndScript
		End
		AnimationState					= EMOTION_AFRAID 
			StateName					= STATE_Emotion_Bow
			Animation					= Bow
				AnimationName			= MUSpidRdr_FERB
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End	
			Animation					= Bow2
				AnimationName			= MUSpidRdr_FERB
				AnimationMode			= ONCE
				AnimationBlendTime		= 15
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
					end
				end
			EndScript	
		End
		
;;====== CELEBRATING		
;
;		AnimationState					= EMOTION_CELEBRATING WEAPONSET_TOGGLE_1
;			StateName					= STATE_Emotion_Sword
;			Animation					= Sword
;				AnimationName			= RUElfWar_CHRST2
;				AnimationMode			= ONCE
;			End
;			Animation					= Sword2
;				AnimationName			= RUElfWar_CHRST2
;				AnimationMode			= ONCE
;			End
;			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
;			BeginScript
;				PrevState = CurDrawablePrevAnimationState()
;				CurDrawableHideSubObject("arrow")
;				CurDrawableHideSubObject("arrownock")
;				
;				if PrevState == "STATE_Emotion_Bow"
;				then
;					CurDrawableAllowToContinue()
;					if( CurDrawablePrevAnimFraction() > .89 )
;					then
;						CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
;					end
;				elseif PrevState == "STATE_Emotion_Sword"
;				then
;					CurDrawableAllowToContinue()
;				elseif PrevState == "Selected_Sword"
;				then
;					CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
;				elseif PrevState == "Bored_Sword"
;				then
;					CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
;				end
;			EndScript
;		End
;		AnimationState					= EMOTION_CELEBRATING
;			StateName					= STATE_Emotion_Bow
;			Animation					= Bow
;				AnimationName			= RUElfWar_CHRB
;				AnimationMode			= ONCE
;			End
;			Animation					= Bow2
;				AnimationName			= RUElfWar_CHRB
;				AnimationMode			= ONCE
;			End
;			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
;			BeginScript
;				PrevState = CurDrawablePrevAnimationState()
;				CurDrawableShowSubObject("arrow")
;				CurDrawableShowSubObject("arrownock")
;				
;				if PrevState == "STATE_Emotion_Sword"
;				then
;					CurDrawableAllowToContinue()
;					if( CurDrawablePrevAnimFraction() > .89 )
;					then
;						CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
;					end
;				elseif PrevState == "STATE_Emotion_Bow"
;				then
;					CurDrawableAllowToContinue()
;				elseif PrevState == "Selected_Bow"
;				then
;					CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
;;				elseif PrevState == "Bored_Bow"
;;				then
;;					CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
;				end
;			EndScript	
;		End
;
;;====== TAUNTING
;
;		AnimationState					= EMOTION_TAUNTING WEAPONSET_TOGGLE_1
;			StateName					= STATE_Emotion_Sword
;			Animation					= Sword
;				AnimationName			= RUElfWar_TNTSV1
;				AnimationMode			= ONCE
;			End
;			Animation					= Sword2
;				AnimationName			= RUElfWar_TNTSV1
;				AnimationMode			= ONCE
;			End
;			Flags						= RESTART_ANIM_WHEN_COMPLETE ;MAINTAIN_FRAME_ACROSS_STATES
;			BeginScript
;				PrevState = CurDrawablePrevAnimationState()
;				CurDrawableHideSubObject("arrow")
;				CurDrawableHideSubObject("arrownock")
;				
;				if PrevState == "STATE_Emotion_Bow"
;				then
;					CurDrawableAllowToContinue()
;					if( CurDrawablePrevAnimFraction() > .89 )
;					then
;						CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
;					end
;				elseif PrevState == "STATE_Emotion_Sword"
;					then
;						CurDrawableAllowToContinue()
;				elseif PrevState == "Selected_Sword"
;				then
;					CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
;				elseif PrevState == "Bored_Sword"
;				then
;					CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
;				end
;			EndScript
;		End
;		AnimationState					= EMOTION_TAUNTING
;			StateName					= STATE_Emotion_Bow
;			Animation					= Bow1
;				AnimationName			= RUElfWar_TNTB
;				AnimationMode			= ONCE
;			End
;			Animation					= Bow2
;				AnimationName			= RUElfWar_TNTB		; RUElfWar_TNTBX anim does not exist
;				AnimationMode			= ONCE
;			End
;			Flags						= RESTART_ANIM_WHEN_COMPLETE ;MAINTAIN_FRAME_ACROSS_STATES
;			BeginScript
;				PrevState = CurDrawablePrevAnimationState()
;				CurDrawableShowSubObject("arrow")
;				CurDrawableShowSubObject("arrownock")
;				
;				if PrevState == "STATE_Emotion_Sword"
;				then
;					CurDrawableAllowToContinue()
;					if( CurDrawablePrevAnimFraction() > .89 )
;					then
;						CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
;					end
;				elseif PrevState == "STATE_Emotion_Bow"
;				then
;					CurDrawableAllowToContinue()
;				elseif PrevState == "Selected_Bow"
;				then
;					CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
;				elseif PrevState == "Bored_Bow"
;				then
;					CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
;				end
;			EndScript
;		End
;
;;====== POINTING

		AnimationState					= EMOTION_POINTING WEAPONSET_TOGGLE_1
			StateName					= STATE_Emotion_Sword
			Animation					= Sword
				AnimationName			= MUSpidRdr_PNTA
				AnimationMode			= ONCE
			End
			Animation					= Sword2
				AnimationName			= MUSpidRdr_PNTB
				AnimationMode			= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableHideSubObject("arrow")
				CurDrawableHideSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_BowToSword_Ready")
					end
				elseif PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
				elseif PrevState == "Selected_Sword"
				then
					CurDrawableSetTransitionAnimState("TRANS_SR_Sword")
				elseif PrevState == "Bored_Sword"
				then
					CurDrawableSetTransitionAnimState("TRANS_BR_Sword")
				end
			EndScript
		End
		AnimationState					= EMOTION_POINTING
			StateName					= STATE_Emotion_Bow
			Animation					= Bow
				AnimationName			= MUSpidRdr_PNTB
				AnimationMode			= ONCE
			End
			Animation					= Bow2
				AnimationName			= MUSpidRdr_PNTB
				AnimationMode			= ONCE
			End
			Flags						= MAINTAIN_FRAME_ACROSS_STATES RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				PrevState = CurDrawablePrevAnimationState()
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				
				if PrevState == "STATE_Emotion_Sword"
				then
					CurDrawableAllowToContinue()
					if( CurDrawablePrevAnimFraction() > .89 )
					then
						CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Ready")
					end
				elseif PrevState == "STATE_Emotion_Bow"
				then
					CurDrawableAllowToContinue()
				elseif PrevState == "Selected_Bow"
				then
					CurDrawableSetTransitionAnimState("TRANS_SR_Bow")
				elseif PrevState == "Bored_Bow"
				then
					CurDrawableSetTransitionAnimState("TRANS_BR_Bow")
				end
			EndScript
		End
		
		; ------ Selected ------ ;

		AnimationState				=	SELECTED WEAPONSET_TOGGLE_1
			StateName				=	Selected_Sword
			
			Animation				=	ATNA
				AnimationName		=	MUSpidRdr_ATNB
				AnimationMode		=	LOOP
			End
			
			BeginScript
				CurDrawableHideSubObject("ARROW")
				CurDrawableHideSubObject("ARROWNOCK")
				
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
				if Prev == "Bored_Sword"		then CurDrawableSetTransitionAnimState("TRANS_BS_Sword")		end
				if Prev == "Ready_Sword"		then CurDrawableSetTransitionAnimState("TRANS_RS_Sword")		end
				if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
				then
					CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")	
				end
				
			EndScript
		End

		AnimationState				=	SELECTED 
			StateName           	=	Selected_Bow
			
			Animation				=	ATNE
				AnimationName		=	MUSpidRdr_ATNF
				AnimationMode		=	LOOP
			End
			
			BeginScript
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_Emotion_Bow" or Prev == "STATE_Emotion_Sword" then CurDrawableAllowToContinue() end
				if Prev == "Bored_Bow" then CurDrawableSetTransitionAnimState("TRANS_BS_Bow")				end
				if Prev == "Ready_Bow" then CurDrawableSetTransitionAnimState("TRANS_RS_Bow")				end
				if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
				then 
					CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")	
				end	
			EndScript
		End
		
		
		; --------- Hit Reactions ---------- ;
		
		AnimationState						= HIT_REACTION HIT_LEVEL_1 WEAPONSET_TOGGLE_1
			StateName						= Bored_Sword
			Animation						= Hit_Level_1_a
				AnimationName				= MUSpidRdr_HITA
				AnimationMode				= ONCE
			End
		End

		AnimationState 						= HIT_REACTION HIT_LEVEL_1
			StateName						= Bored_Bow
			Animation 						= Hit_Level_1_a
				AnimationName				= MUSpidRdr_HITB
				AnimationMode 				= ONCE
;				AnimationSpeedFactorRange	= .9 .9
			End
		End
		
		
		; ------- Bored -------- ;
		
		AnimationState					= WEAPONSET_TOGGLE_1
			StateName					= Bored_Sword
			
			Animation           		= Idle_Sword1
				AnimationName       	= MUSpidRdr_IDLA
				AnimationMode       	= ONCE
			End
			Animation           		= Idle_Sword2
				AnimationName       	= MUSpidRdr_IDLA
				AnimationMode       	= ONCE
			End
			Animation           		= Idle_Sword3
				AnimationName       	= MUSpidRdr_IDLA
				AnimationMode       	= ONCE
			End
			Animation					= IdleNoFidget
				AnimationName			= MUSpidRdr_IDLA
				AnimationMode			= ONCE
				AnimationPriority		= 20
			End
			Animation					= IdleNoFidget2
				AnimationName			= MUSpidRdr_IDLA
				AnimationMode			= ONCE
				AnimationPriority		= 0
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
			BeginScript
				CurDrawableHideSubObject("ARROW")
				CurDrawableHideSubObject("ARROWNOCK")				

				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "TRANS_SB_Sword" or Prev == "TRANS_RB_Sword" then return "IdleNoFidget" end
				if Prev == "Selected_Sword"		then CurDrawableSetTransitionAnimState("TRANS_SB_Sword")		end
				if Prev == "Ready_Sword"		then CurDrawableSetTransitionAnimState("TRANS_RB_Sword")		end
				if Prev == "Selected_Bow" or Prev == "Moving_Bow" or Prev == "Ready_Bow" or Prev == "Bored_Bow" or PrevAnim == "WantSword"
				then 
					CurDrawableSetTransitionAnimState("TRANS_BowToSword_Selected")	
				end
			EndScript
		End
		
		IdleAnimationState
			StateName					= Bored_Bow
			
			Animation					= IdleBowB
				AnimationName			= MUSpidRdr_IDLB
				AnimationMode			= ONCE
			End
			Animation					= IdleBowD
				AnimationName			= MUSpidRdr_IDLB
				AnimationMode			= ONCE
			End
			Animation					= IdleNoFidget
				AnimationName			= MUSpidRdr_IDLB
				AnimationMode			= ONCE
				AnimationPriority		= 20
			End
			Animation					= IdleNoFidget2
				AnimationName			= MUSpidRdr_IDLB
				AnimationMode			= ONCE
				AnimationPriority		= 10
			End
			Flags						= RESTART_ANIM_WHEN_COMPLETE
			BeginScript	
				CurDrawableShowSubObject("arrow")
				CurDrawableShowSubObject("arrownock")			
				PrevAnim = CurDrawablePrevAnimation()
				Prev = CurDrawablePrevAnimationState()
				if Prev == "TRANS_SB_Bow" or Prev == "TRANS_RB_Bow" then return "IdleNoFidget" end
				if Prev == "Selected_Bow"		then CurDrawableSetTransitionAnimState("TRANS_SB_Bow")		end
				if Prev == "Ready_Bow"			then CurDrawableSetTransitionAnimState("TRANS_RB_Bow")		end
				if Prev == "Selected_Sword" or Prev == "Moving_Sword" or Prev == "Ready_Sword" or Prev == "Bored_Sword" or PrevAnim == "WantBow"
				then 
					CurDrawableSetTransitionAnimState("TRANS_SwordToBow_Selected")	
				end	
			EndScript
		End

		
		;----------------- Bow Transitions -------------------------;

		TransitionState       			= TRANS_BS_Bow
			Animation           		= ATND
				AnimationName     		= MUSpidRdr_TGLA
				AnimationMode     		= ONCE
				AnimationBlendTime		= 10
			End
		End
		
		TransitionState       			= TRANS_SR_Bow
			Animation           		= ATNE
				AnimationName     		= MUSpidRdr_TGLA
				AnimationMode     		= ONCE
			End
		End
		
		TransitionState       			= TRANS_SB_Bow
			Animation           		= ATND
				AnimationName     		= MUSpidRdr_TGLA
				AnimationMode     		= ONCE_BACKWARDS
			End
			Flags						= START_FRAME_LAST
		End
		
		TransitionState       			= TRANS_RS_Bow
			Animation           		= ATNF
				AnimationName     		= MUSpidRdr_TGLA
				AnimationMode     		= ONCE_BACKWARDS
			End
			Flags						= START_FRAME_LAST
		End
		
		TransitionState       			= TRANS_BR_Bow
			Animation           		= IDLB
				AnimationName     		= MUSpidRdr_TGLA
				AnimationMode     		= ONCE
				AnimationBlendTime		= 20
			End
		End
		
		TransitionState       			= TRANS_RB_Bow
			Animation           		= IDLD
				AnimationName     		= MUSpidRdr_TGLA
				AnimationMode     		= ONCE
				AnimationBlendTime		= 20
			End
		End
		
		;----------------- Sword Transitions -------------------------;
		
		TransitionState       			= TRANS_BS_Sword
			Animation           		= ATNA
				AnimationName     		= MUSpidRdr_TGLB
				AnimationMode     		= ONCE
			End
			Animation           		= ATNAX1
				AnimationName     		= MUSpidRdr_TGLB
				AnimationMode     		= ONCE
			End
		End
		
		TransitionState       			= TRANS_SR_Sword
			Animation           		= ATNC
				AnimationName     		= MUSpidRdr_TGLB
				AnimationMode     		= ONCE
			End
		End
		
		TransitionState       			= TRANS_SB_Sword
			Animation           		= ATNA
				AnimationName     		= MUSpidRdr_TGLB
				AnimationMode     		= ONCE_BACKWARDS
			End
			Flags						= START_FRAME_LAST
		End
		
		TransitionState       			= TRANS_RS_Sword
			Animation           		= ATNC
				AnimationName     		= MUSpidRdr_TGLB
				AnimationMode     		= ONCE_BACKWARDS
			End
			Flags						= START_FRAME_LAST
		End
		
		TransitionState       			= TRANS_BR_Sword
			Animation           		= ATNS
				AnimationName     		= MUSpidRdr_TGLB
				AnimationMode     		= ONCE
				AnimationBlendTime		= 20
			End
		End
		
		TransitionState       			= TRANS_RB_Sword
			Animation           		= IDLG
				AnimationName     		= MUSpidRdr_TGLB
				AnimationMode     		= ONCE
				AnimationBlendTime		= 20
			End
		End
		

		;-------------- Weapon Change Transitions --------------------------;		

		TransitionState       			= TRANS_BowToSword_Ready
			Animation           		= DrawSwords
				AnimationName       	= MUSpidRdr_TGLB
				AnimationMode       	= ONCE
			End
		End

		TransitionState       			= TRANS_SwordToBow_Ready
			Animation           		= DrawBow
				AnimationName       	= MUSpidRdr_TGLA
				AnimationMode       	= ONCE
			End
		End
		
		TransitionState       			= TRANS_BowToSword_Selected
			Animation           		= DrawSwords
				AnimationName       	= MUSpidRdr_TGLB
				AnimationMode       	= ONCE
			End
		End

		TransitionState       			= TRANS_SwordToBow_Selected
			Animation           		= DrawBow
				AnimationName       	= MUSpidRdr_TGLA
				AnimationMode       	= ONCE
			End
		End
	End
	
	; ***DESIGN parameters ***
	Side			= Wild
	IsTrainable		= Yes
	EditorSorting	= UNIT
	ThreatLevel		= 1.0
	ThingClass		= HORDE_UNIT
	CommandPoints	= 1
	
	TransportSlotCount = TRANSPORTSLOTCOUNT_UNIT

	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    WildSpiderRiderBow
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
	
	WeaponSet
		Conditions = WEAPONSET_TOGGLE_1					; CONTESTING_BUILDING
		Weapon = PRIMARY WildSpiderRiderSword					;GondorRangerSword
		AutoChooseSources = PRIMARY FROM_PLAYER FROM_SCRIPT FROM_AI
	End
		
	ArmorSet
		Conditions      = None
		Armor           = WildSpiderRiderArmor
		DamageFX        = NormalDamageFX
	End

	ArmorSet
		Conditions      = PLAYER_UPGRADE
		Armor           = SpecialistHeavyArmor
		DamageFX        = NormalDamageFX
	End

	VisionRange			= VISION_STANDARD_MELEE
	DisplayName			= OBJECT:WildSpiderRider
	BountyValue			= WILD_SPIDERRIDER_BOUNTTY_VALUE	
	CrushableLevel		= 3  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel		= 1
	CrushWeapon			= SpiderRiderCrush

	MinCrushVelocityPercent		= 40 ; Has to be moving at at least 35% of full speed.
	CrushDecelerationPercent	= 20 ; Lose 20 percent of max velocity when crushing.

	CrushKnockback = 40;
	CrushZFactor = 1.0;
	
	CommandSet			= WildSpiderRiderCommandSet	

	
	; *** AUDIO Parameters ***;

	VoiceAttack			= SpiderRiderVoiceAttack
	VoiceAttackCharge		= SpiderRiderVoiceAttackCharge
	VoiceAttackMachine	= SpiderRiderVoiceAttack
	VoiceAttackStructure	= SpiderRiderVoiceAttackBuilding
	VoiceGuard			= SpiderRiderVoiceGuard
	VoiceMove			= SpiderRiderVoiceMove
	VoiceSelect			= SpiderRiderVoiceSelectMS
	VoiceSelectBattle		= SpiderRiderVoiceSelectBattleMS

	SoundImpact 		= ImpactHorse
	SoundMoveLoop		= WildSpiderRiderMoveLoop

	;UnitSpecificSounds
	;End

	CrowdResponseKey = Goblin

    #include "..\includes\StandardUnitEvaEvents.inc"

	;ClientBehavior = ModelConditionAudioLoopClientBehavior ModuleTag_ModelConditionAudioLoop
	;	ModelCondition = Required:MOVING Sound:WildSpiderRiderMoveLoop
	;End

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU		;Tie into LargeGroupAudio system
		Key = SpiderRider
	End

	; *** ENGINEERING Parameters ***

  RadarPriority = UNIT
  KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS CAVALRY SCORE THROWN_OBJECT ARCHER ATTACK_NEEDS_LINE_OF_SIGHT GRAB_AND_DROP ;PATH_THROUGH_EACH_OTHER
  CamouflageDetectionMultiplier = 0.8
 
  Body = ActiveBody ModuleTag_02
    MaxHealth         = WILD_SPIDERRIDER_HEALTH
    MaxHealthDamaged  = 5
  End
 
	;-------------------------Units Upgrades-------------------
	; Fire arrow upgrade
	Behavior = WeaponSetUpgrade Weapon_Upgrade1
		TriggeredBy = Upgrade_WildFireArrows
	End
	
	; Switch arrows being displayed.
	Behavior = SubObjectsUpgrade Weapon_UpgradeSwap1
		TriggeredBy		= Upgrade_WildFireArrows
		ShowSubObjects	= FireArowTip
	End	
	
	Behavior = WeaponSetUpgrade Weapon_Upgrade2
		TriggeredBy = Upgrade_WildForgedBlades
	End
	
	Behavior = SubObjectsUpgrade Weapon_UpgradeSwap2
		TriggeredBy		= Upgrade_WildForgedBlades
		ShowSubObjects	= FireArowTip
	End	
	;----------------------------------------------------------
;	Behavior = WeaponSetUpgrade WeaponSetUpgradeModuleTag
;		TriggeredBy = Upgrade_RohanForgedBladesForElves
;		CustomAnimAndDuration   = AnimState:USER_5 AnimTime:0 TriggerTime:0 ;set flag forever
;	End

;	Behavior = SubObjectsUpgrade Armor_Upgrade
;		TriggeredBy		= Upgrade_RohanHeavyArmorForElves
;		UpgradeTexture	= RUElvnWorrior.tga 0 RUElvnWorriorHA.tga
;		UpgradeTexture	= RUElvnWorrior_L.tga 0 RUElvnWorriorHA.tga
;		RecolorHouse	= Yes
;	End
	
;	Behavior = ArmorUpgrade ArmorUpgradeModuleTag
;		TriggeredBy = Upgrade_RohanHeavyArmorForElves
;	End
	
;	Behavior = SubObjectsUpgrade ForgedBlades_Upgrade
;		TriggeredBy		= Upgrade_RohanForgedBladesForElves
;		ShowSubObjects	= Forged_Blade
;	End

 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf					=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf				=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER +CloudBreakSunbeam +SunflareSunbeam
		PointAt						=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance			=	150
		FearScanDistance			=	ARCHER_FEAR_SCAN_RADIUS ;250

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=   BraceForBeingCrushed_Base
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End	


	#include "..\includes\CaptureBuilding.inc"

	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End
 
  Behavior = AIUpdateInterface ModuleTag_03
    AutoAcquireEnemiesWhenIdle	=	Yes ATTACK_BUILDINGS
    MoodAttackCheckRate			=	500
	AILuaEventsList				=	WildSpiderFunctions
    AttackPriority				= 	AttackPriority_Cavalry
  End

	;LocomotorSet
		;Locomotor = NormalHorseHordeMemberLocomotor
		;Condition = SET_NORMAL 
		;Speed     = NORMAL_WILD_CAVALRY_MEMBER_SPEED
	;End

	LocomotorSet
		Locomotor     = TestWallScalingHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_WILD_FAST_MEMBER_SPEED
	End

	LocomotorSet
		Locomotor = NormalHorseHordeMemberLocomotor
		Condition = SET_COMBO
		Speed     = NORMAL_WILD_CAVALRY_MEMBER_SPEED
	End


	; Fire arrow upgrade
;	Behavior = WeaponSetUpgrade ModuleTag_14
;		TriggeredBy = Upgrade_WildFireArrows
;	End
	
;	;Behavior = DualWeaponBehavior ModuleTag_13
;	;	SwitchWeaponOnCloseRangeDistance = 41
;	;End

  Behavior = PhysicsBehavior ModuleTag_04
    GravityMult				= 1.0
    ShockStunnedTimeLow		= 800	;msec
    ShockStunnedTimeHigh	= 1000	;msec
    ShockStandingTime		= 2133	;msec
  End
 
  Behavior = SlowDeathBehavior ModuleTag_05
    DeathTypes			= ALL -KNOCKBACK
    SinkDelay			= 3000
    SinkRate			= 4.0     ; in Dist/Sec
    DestructionDelay	= 8000
    Sound				= INITIAL GoblinVoiceDie
  End

  
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End

  Behavior = BezierProjectileBehavior ModuleTag_08 ; Module starts asleep, and wakes up when thrown.
    ; 
    FirstHeight					= 24	; Height of Bezier control points above highest intervening terrain
    SecondHeight				= 24
    FirstPercentIndent			= 30%	; Percentage of shot distance control points are placed
    SecondPercentIndent			= 70%
    TumbleRandomly				= Yes

    CrushStyle					= Yes	; I don't detonate, I just hit
    DieOnImpact					= Yes
    BounceCount					= 1		; When I hit the ground, I'll arc again
    BounceDistance				= 40	; this far
    BounceFirstHeight			= 24	; Height of Bezier control points above highest intervening terrain
    BounceSecondHeight			= 24
    BounceFirstPercentIndent	= 20%	; Percentage of shot distance control points are placed
    BounceSecondPercentIndent	= 80%

    GroundHitFX       = FX_ThrownRockGroundHit
    GroundBounceFX    = FX_ThrownRockBounceHit
  End	
  
	;-----------------

    
  Geometry				= CYLINDER
  GeometryMajorRadius	= 8.0
  GeometryMinorRadius	= 8.0
  GeometryHeight		= 19.2
  GeometryIsSmall		= Yes
  
  Shadow				= SHADOW_VOLUME
;  ShadowSizeX			= 11
;  ShadowSizeY			= 11
;  ShadowTexture			= ShadowI

End

